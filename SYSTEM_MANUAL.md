# ä¹ä¹ç“¦æ–¯è¡Œç®¡ç†ç³»çµ± - å®Œæ•´åŠŸèƒ½ç®¡ç†æ–‡æª”

> ğŸ“‹ **ç‰ˆæœ¬**: v1.0.0
> ğŸ“… **æ›´æ–°æ—¥æœŸ**: 2025-01-25
> ğŸ‘¥ **é–‹ç™¼åœ˜éšŠ**: JyæŠ€è¡“åœ˜éšŠ
> ğŸŒ **å®˜æ–¹ç¶²ç«™**: https://jytian.it.com

---

## ğŸ“š ç›®éŒ„

1. [ç³»çµ±æ¦‚è¿°](#ç³»çµ±æ¦‚è¿°)
2. [åŠŸèƒ½æ¨¡çµ„è©³è§£](#åŠŸèƒ½æ¨¡çµ„è©³è§£)
3. [ç”¨æˆ¶è§’è‰²èˆ‡æ¬Šé™](#ç”¨æˆ¶è§’è‰²èˆ‡æ¬Šé™)
4. [æ¥­å‹™æµç¨‹](#æ¥­å‹™æµç¨‹)
5. [API æ¥å£æ–‡æª”](#api-æ¥å£æ–‡æª”)
6. [æ•¸æ“šæ¨¡å‹](#æ•¸æ“šæ¨¡å‹)
7. [ç³»çµ±é…ç½®](#ç³»çµ±é…ç½®)

---

## ç³»çµ±æ¦‚è¿°

### ğŸ¯ ç³»çµ±å®šä½

**ä¹ä¹ç“¦æ–¯è¡Œç®¡ç†ç³»çµ±**æ˜¯ä¸€æ¬¾å°ˆç‚ºå°ç£ç“¦æ–¯è¡Œæ¥­è¨­è¨ˆçš„å…¨æ–¹ä½ç‡Ÿé‹ç®¡ç†è§£æ±ºæ–¹æ¡ˆï¼Œç‰¹åˆ¥é‡å°ä¸­å¹´é•·ç”¨æˆ¶å„ªåŒ–ï¼Œå…·å‚™å¤§å‹å­—é«”ã€å¤§æŒ‰éˆ•å’Œç°¡åŒ–æ“ä½œæµç¨‹ã€‚

### âœ¨ æ ¸å¿ƒç‰¹è‰²

| ç‰¹è‰² | èªªæ˜ |
|------|------|
| ğŸ“± **iOS å„ªåŒ–** | PWA æ¶æ§‹ï¼Œå®Œç¾æ”¯æ´ iPhone/iPad |
| ğŸ‘µ **é•·è€…å‹å–„** | 18px+ å¤§å­—é«”ã€52px å¤§æŒ‰éˆ•ã€è§¸è¦ºå›é¥‹ |
| ğŸ¤– **AI åŠ©æ‰‹** | BossJy-99 èªéŸ³åŠ©æ‰‹ï¼Œè‡ªç„¶èªè¨€æ“ä½œ |
| ğŸ“Š **å®Œæ•´æ¥­å‹™** | è¨‚å–®â†’åº«å­˜â†’é…é€â†’æ”¶è²» å®Œæ•´é–‰ç’° |
| ğŸ”’ **å®‰å…¨å¯é ** | JWT èªè­‰ã€è§’è‰²æ¬Šé™ã€æ“ä½œæ—¥èªŒ |

### ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ¶å±¤ (Presentation)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  iOS Safari PWA  â”‚  Android Chrome  â”‚  Desktop Browser      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ‡‰ç”¨å±¤ (Application)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Next.js 15  â”‚  React 19  â”‚  Tailwind CSS  â”‚  shadcn/ui    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ¥­å‹™å±¤ (Business Logic)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API Routes  â”‚  Validation  â”‚  AI Assistant  â”‚  LINE Bot    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•¸æ“šå±¤ (Data Layer)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Prisma ORM  â”‚  PostgreSQL/MySQL/SQLite  â”‚  Transactions    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åŠŸèƒ½æ¨¡çµ„è©³è§£

### 1ï¸âƒ£ ğŸ  é¦–é å„€è¡¨æ¿

**è·¯ç”±**: `/` â†’ `dashboard`

#### åŠŸèƒ½æè¿°
ç³»çµ±çš„ä¸»å…¥å£ï¼Œæä¾›å¿«é€Ÿæ“ä½œå…¥å£å’Œä»Šæ—¥ç‡Ÿé‹æ¦‚æ³ã€‚

#### æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **å¿«é€Ÿæ“ä½œ** | 4å€‹å¿«æ·å…¥å£ï¼šæ–°å¢å®¢æˆ¶ã€å‰µå»ºè¨‚å–®ã€æŸ¥çœ‹åº«å­˜ã€æŠ„éŒ¶è¨ˆç®— |
| **ä»Šæ—¥æ¦‚æ³** | 6å€‹é—œéµæŒ‡æ¨™å¡ç‰‡ |
| **ç³»çµ±åˆå§‹åŒ–** | ä¸€éµå»ºç«‹åˆå§‹æ•¸æ“š |

#### ä»Šæ—¥æ¦‚æ³æŒ‡æ¨™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»Šæ—¥è¨‚å–®æ•¸  â”‚  å¾…é…é€æ•¸é‡  â”‚  æœ¬æœˆç‡Ÿæ¥­é¡  â”‚
â”‚     12      â”‚      5      â”‚   $128,500  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®¢æˆ¶ç¸½æ•¸    â”‚  ç“¦æ–¯åº«å­˜   â”‚  å¾…æ”¶æ”¯ç¥¨    â”‚
â”‚    156      â”‚   20kg:45   â”‚     3 å¼µ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2025å¹´ç“¦æ–¯åƒè€ƒåƒ¹æ ¼

| è¦æ ¼ | é›¶å”®åƒ¹ | æˆæœ¬åƒ¹ |
|------|--------|--------|
| 20kg æ¡¶è£ç“¦æ–¯ | $620 | $480 |
| 16kg æ¡¶è£ç“¦æ–¯ | $520 | $400 |
| 50kg æ¡¶è£ç“¦æ–¯ | $1,550 | $1,200 |

#### ç³»çµ±åˆå§‹åŒ–å…§å®¹

åŸ·è¡Œ `/api/init` å¾Œå‰µå»ºï¼š

1. **ç®¡ç†å“¡å¸³è™Ÿ**
   - ç”¨æˆ¶å: `admin`
   - å¯†ç¢¼: `Uu19700413`
   - å§“å: è€é—†å¨˜
   - è§’è‰²: ç³»çµ±ç®¡ç†å“¡

2. **ç”¢å“åˆ†é¡** (4å€‹)
   - ç“¦æ–¯ã€çˆå…·ã€ç†±æ°´å™¨ã€é…ä»¶

3. **é è¨­ç”¢å“** (22å€‹)
   - ç“¦æ–¯: 4kg ~ 50kg å…± 6 ç¨®è¦æ ¼
   - çˆå…·: 8 ç¨®å‹è™Ÿ
   - ç†±æ°´å™¨: 5 ç¨®å‹è™Ÿ
   - é…ä»¶: 3 ç¨®å¸¸ç”¨é…ä»¶

4. **å®¢æˆ¶åˆ†çµ„** (5å€‹)
   - ä¸€èˆ¬å®¢æˆ¶ (ç„¡æŠ˜æ‰£)
   - VIP å®¢æˆ¶ (5% æŠ˜æ‰£)
   - æ‰¹ç™¼å•† (10% æŠ˜æ‰£)
   - æœˆçµå®¢æˆ¶ (ä¿¡ç”¨é¡åº¦)
   - ç¾é‡‘å®¢æˆ¶ (å³æ™‚ä»˜æ¬¾)

---

### 2ï¸âƒ£ ğŸ‘¥ å®¢æˆ¶ç®¡ç†

**è·¯ç”±**: `/` â†’ `customers`
**API**: `/api/customers/`

#### åŠŸèƒ½æè¿°
ç®¡ç†æ‰€æœ‰å®¢æˆ¶è³‡è¨Šï¼ŒåŒ…æ‹¬ç¾é‡‘å®¢æˆ¶å’Œæœˆçµå®¢æˆ¶ã€‚

#### æ ¸å¿ƒåŠŸèƒ½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å®¢æˆ¶ç®¡ç†åŠŸèƒ½                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ æ–°å¢å®¢æˆ¶                                 â”‚
â”‚  âœï¸  ç·¨è¼¯å®¢æˆ¶è³‡æ–™                            â”‚
â”‚  ğŸ—‘ï¸  åˆªé™¤å®¢æˆ¶                                 â”‚
â”‚  ğŸ” æœå°‹å®¢æˆ¶ (å§“å/é›»è©±/åœ°å€)                 â”‚
â”‚  ğŸ“Š æŸ¥çœ‹å®¢æˆ¶è¨‚å–®æ­·å²                          â”‚
â”‚  ğŸ’° æŸ¥çœ‹å®¢æˆ¶æ¬ æ¬¾é¤˜é¡                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®¢æˆ¶è³‡æ–™æ¬„ä½

| æ¬„ä½ | èªªæ˜ | å¿…å¡« |
|------|------|------|
| å§“å | å®¢æˆ¶åç¨± | âœ… |
| é›»è©± | æ‰‹æ©Ÿè™Ÿç¢¼ (å”¯ä¸€) | âœ… |
| åœ°å€ | é…é€åœ°å€ | âœ… |
| å®¢æˆ¶åˆ†çµ„ | æ±ºå®šæŠ˜æ‰£ç‡ | âœ… |
| ä»˜æ¬¾æ–¹å¼ | `cash` / `monthly` | âœ… |
| ä¿¡ç”¨é¡åº¦ | æœˆçµå®¢æˆ¶ä¿¡ç”¨ä¸Šé™ | - |
| æ¬ æ¬¾é¤˜é¡ | ç•¶å‰æœªçµé‡‘é¡ | - |
| å‚™è¨» | å®¢æˆ¶ç‰¹æ®Šéœ€æ±‚ | - |

#### å®¢æˆ¶åˆ†çµ„èˆ‡æŠ˜æ‰£

| åˆ†çµ„ | æŠ˜æ‰£ | é©ç”¨å ´æ™¯ |
|------|------|----------|
| ä¸€èˆ¬å®¢æˆ¶ | 0% | é›¶æ•£å®¢æˆ¶ |
| VIP å®¢æˆ¶ | 5% | é•·æœŸå„ªè³ªå®¢æˆ¶ |
| æ‰¹ç™¼å•† | 10% | å¤§é‡æ¡è³¼ |
| æœˆçµå®¢æˆ¶ | è‡ªè¨‚ | ä¼æ¥­å®¢æˆ¶ |
| ç¾é‡‘å®¢æˆ¶ | 0% | å³æ™‚ä»˜æ¬¾ |

#### æœå°‹åŠŸèƒ½

- **æŒ‰å§“åæœå°‹**: æ”¯æ´æ¨¡ç³ŠåŒ¹é…
- **æŒ‰é›»è©±æœå°‹**: ç²¾ç¢ºåŒ¹é…
- **æŒ‰åœ°å€æœå°‹**: æ”¯æ´æ¨¡ç³ŠåŒ¹é…
- **æŒ‰åˆ†çµ„ç¯©é¸**: ä¸‹æ‹‰é¸æ“‡

#### API ç«¯é»

```
GET  /api/customers/          # ç²å–å®¢æˆ¶åˆ—è¡¨
POST /api/customers/          # å‰µå»ºæ–°å®¢æˆ¶
GET  /api/customers/[id]      # ç²å–å–®ä¸€å®¢æˆ¶
PUT  /api/customers/[id]      # æ›´æ–°å®¢æˆ¶
DELETE /api/customers/[id]    # åˆªé™¤å®¢æˆ¶
```

---

### 3ï¸âƒ£ ğŸ›µ è¨‚å–®ç®¡ç†

**è·¯ç”±**: `/` â†’ `orders`
**API**: `/api/orders/`

#### åŠŸèƒ½æè¿°
è™•ç†æ‰€æœ‰ç“¦æ–¯è¨‚å–®ï¼Œå¾å‰µå»ºåˆ°é…é€å®Œæˆã€‚

#### è¨‚å–®ç‹€æ…‹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pending â”‚â”€â”€â”€â–¶â”‚deliveringâ”‚â”€â”€â”€â–¶â”‚completed â”‚
â”‚  å¾…è™•ç†   â”‚    â”‚  é…é€ä¸­   â”‚    â”‚  å·²å®Œæˆ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                              â”‚
       â”‚                              â–¼
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ cancelled
                                     å·²å–æ¶ˆ
```

#### è¨‚å–®å‰µå»ºæµç¨‹ (8æ­¥äº¤æ˜“)

```javascript
// 1. æ‰¹æ¬¡æŸ¥è©¢ç”¢å“
products = await db.product.findMany({ where: { id: { in: productIds } } })

// 2. æª¢æŸ¥åº«å­˜
for each item:
  if product.inventory.quantity < item.quantity:
    throw Error("åº«å­˜ä¸è¶³")

// 3. è¨ˆç®—å°è¨ˆ (å«å®¢æˆ¶æŠ˜æ‰£)
subtotal = sum(item.price * item.quantity)
discount = subtotal * customer.group.discount
total = subtotal - discount

// 4. è¨ˆç®—é‹è²»
deliveryFee = (total >= 2000) ? 0 : 50

// 5. å‰µå»ºè¨‚å–®
order = await db.gasOrder.create({
  orderNo: "GAS20250125001",
  status: "pending",
  total: total + deliveryFee
})

// 6. æ‰£é™¤åº«å­˜
await db.inventory.update({
  quantity: { decrement: item.quantity }
})

// 7. è¨˜éŒ„åº«å­˜è®Šå‹•
await db.inventoryTransaction.create({
  type: "delivery",
  quantityBefore,
  quantityAfter
})

// 8. æ›´æ–°å®¢æˆ¶æœ€å¾Œè¨‚å–®æ™‚é–“
await db.customer.update({
  lastOrderAt: new Date()
})
```

#### è¨‚å–®è³‡æ–™çµæ§‹

| æ¬„ä½ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| è¨‚å–®ç·¨è™Ÿ | GAS + å¹´æœˆæ—¥ + åºè™Ÿ | GAS20250125001 |
| å®¢æˆ¶ | é—œè¯å®¢æˆ¶ | ç‹å°æ˜ |
| é…é€å¸æ©Ÿ | é—œè¯å“¡å·¥ | å¸æ©Ÿè€é™³ |
| è¨‚å–®ç‹€æ…‹ | pending/delivering/completed/cancelled | pending |
| å°è¨ˆ | å•†å“ç¸½é¡ | $3,100 |
| æŠ˜æ‰£ | å®¢æˆ¶æŠ˜æ‰£ | $155 (5%) |
| é‹è²» | NT$50 æˆ–å…è²» | $0 |
| ç¸½é¡ | æ‡‰æ”¶é‡‘é¡ | $2,945 |
| å·²ä»˜æ¬¾ | å·²æ”¶é‡‘é¡ | $0 |
| æ”¯ç¥¨ | é—œè¯æ”¯ç¥¨è™Ÿç¢¼ | - |

#### é…é€è²»è¦å‰‡

| è¨‚å–®é‡‘é¡ | é‹è²» |
|----------|------|
| < NT$2,000 | NT$50 |
| â‰¥ NT$2,000 | å…è²» |

#### API ç«¯é»

```
GET    /api/orders/           # ç²å–è¨‚å–®åˆ—è¡¨
POST   /api/orders/           # å‰µå»ºè¨‚å–® (äº‹å‹™è™•ç†)
GET    /api/orders/[id]       # ç²å–è¨‚å–®è©³æƒ…
PUT    /api/orders/[id]       # æ›´æ–°è¨‚å–®ç‹€æ…‹/ä»˜æ¬¾
DELETE /api/orders/[id]       # åˆªé™¤è¨‚å–® (å›å¾©åº«å­˜)
```

---

### 4ï¸âƒ£ ğŸ“¦ åº«å­˜ç®¡ç†

**è·¯ç”±**: `/` â†’ `inventory`
**API**: `/api/inventory/`

#### åŠŸèƒ½æè¿°
å¯¦æ™‚è¿½è¹¤æ‰€æœ‰ç”¢å“åº«å­˜ï¼Œé è­¦åº«å­˜ä¸è¶³ã€‚

#### åº«å­˜æ“ä½œé¡å‹

| é¡å‹ | èªªæ˜ | æ•¸é‡è®ŠåŒ– |
|------|------|----------|
| `purchase` | é€²è²¨ | + |
| `delivery` | éŠ·å”®å‡ºè²¨ | - |
| `return` | å®¢æˆ¶é€€è²¨ | + |
| `adjust` | ç›¤é»èª¿æ•´ | +/- |
| `damaged` | æå£å ±å»¢ | - |

#### åº«å­˜è®Šå‹•è¨˜éŒ„

æ¯æ¬¡åº«å­˜è®Šå‹•éƒ½æœƒè¨˜éŒ„ï¼š

```javascript
{
  productId: "ç”¢å“ID",
  type: "delivery",
  quantity: -2,
  quantityBefore: 47,
  quantityAfter: 45,
  reason: "è¨‚å–® GAS20250125001",
  createdAt: "2025-01-25T10:30:00Z"
}
```

#### åº«å­˜è­¦å ±

ç•¶åº«å­˜ < æœ€ä½åº«å­˜ æ™‚é¡¯ç¤ºè­¦å‘Šï¼š

```
âš ï¸  åº«å­˜è­¦å ±
   20kg ç“¦æ–¯: 45æ¡¶ (æœ€ä½: 50æ¡¶)
   16kg ç“¦æ–¯: 8æ¡¶ (æœ€ä½: 10æ¡¶)
```

#### API ç«¯é»

```
GET /api/inventory/              # ç²å–æ‰€æœ‰åº«å­˜
POST /api/inventory/             # æ›´æ–°åº«å­˜ (äº‹å‹™è™•ç†)
GET /api/inventory/transactions/ # ç²å–åº«å­˜è®Šå‹•è¨˜éŒ„
```

#### åº«å­˜æ›´æ–°é‚è¼¯

```javascript
// 1. é©—è­‰æ•¸é‡
if (quantity < 0 || quantity > 999999) {
  throw Error("æ•¸é‡ç„¡æ•ˆ")
}

// 2. æª¢æŸ¥æ˜¯å¦æœƒå°è‡´è² åº«å­˜
current = await inventory.find({ productId })
if (current.quantity + quantity < 0) {
  throw Error("åº«å­˜ä¸è¶³")
}

// 3. æ›´æ–°åº«å­˜ (äº‹å‹™)
await db.$transaction(async (tx) => {
  // æ›´æ–°åº«å­˜æ•¸é‡
  await tx.inventory.update({
    quantity: { increment: quantity }
  })

  // è¨˜éŒ„è®Šå‹•
  await tx.inventoryTransaction.create({
    type,
    quantity,
    quantityBefore: current.quantity,
    quantityAfter: current.quantity + quantity,
    reason
  })
})
```

---

### 5ï¸âƒ£ ğŸ’³ æ”¯ç¥¨ç®¡ç†

**è·¯ç”±**: `/` â†’ `checks`
**API**: `/api/checks/`

#### åŠŸèƒ½æè¿°
ç®¡ç†æ‰€æœ‰æ”¯ç¥¨ç™»è¨˜ã€å…¥å¸³ã€å…Œç¾æµç¨‹ã€‚

#### æ”¯ç¥¨ç‹€æ…‹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ pending  â”‚â”€â”€â”€â–¶â”‚deposited â”‚â”€â”€â”€â–¶â”‚ cleared  â”‚
â”‚  å¾…å…¥å¸³   â”‚    â”‚  å·²å…¥å¸³   â”‚    â”‚  å·²å…Œç¾   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚
       â”‚              â–¼
       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  bounced â”‚
                  â”‚   è·³ç¥¨   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ”¯ç¥¨è³‡æ–™æ¬„ä½

| æ¬„ä½ | èªªæ˜ | é©—è­‰ |
|------|------|------|
| æ”¯ç¥¨è™Ÿç¢¼ | å”¯ä¸€è­˜åˆ¥ | âœ… å¿…é ˆå”¯ä¸€ |
| éŠ€è¡Œåç¨± | éŠ€è¡Œåç¨± | âœ… å¿…å¡« |
| æ”¯ç¥¨æ—¥æœŸ | åˆ°æœŸæ—¥ | âœ… æ—¥æœŸæ ¼å¼ |
| é‡‘é¡ | æ”¯ç¥¨é‡‘é¡ | âœ… > 0 |
| å®¢æˆ¶ | é—œè¯å®¢æˆ¶ (å¯é¸) | - |
| è¨‚å–® | é—œè¯è¨‚å–® (å¯é¸) | - |
| ç‹€æ…‹ | å½“å‰ç‹€æ…‹ | âœ… é è¨­ pending |

#### æ”¯ç¥¨èˆ‡è¨‚å–®é—œè¯

å‰µå»ºè¨‚å–®æ™‚å¯é¸æ“‡é—œè¯æ”¯ç¥¨ï¼š

```javascript
// å‰µå»ºè¨‚å–®ä¸¦é—œè¯æ”¯ç¥¨
const order = await db.gasOrder.create({
  checkId: "æ”¯ç¥¨ID",  // ä¸€å°ä¸€é—œè¯
  // ...
})

// å‰µå»ºæ”¯ç¥¨ä¸¦é—œè¯è¨‚å–®
const check = await db.check.create({
  orderId: "è¨‚å–®ID",  // ä¸€å°ä¸€é—œè¯
  // ...
})
```

#### API ç«¯é»

```
GET    /api/checks/       # ç²å–æ”¯ç¥¨åˆ—è¡¨
POST   /api/checks/       # å‰µå»ºæ”¯ç¥¨
GET    /api/checks/[id]   # ç²å–æ”¯ç¥¨è©³æƒ…
PUT    /api/checks/[id]   # æ›´æ–°æ”¯ç¥¨ç‹€æ…‹
DELETE /api/checks/[id]   # åˆªé™¤æ”¯ç¥¨
```

---

### 6ï¸âƒ£ ğŸ“Š æŠ„éŒ¶ç®¡ç† (ç®¡ç·šç“¦æ–¯)

**è·¯ç”±**: `/` â†’ `meter`
**API**: `/api/meter-readings/`

#### åŠŸèƒ½æè¿°
é‡å°ç®¡ç·šç“¦æ–¯å®¢æˆ¶çš„æŠ„éŒ¶è¨ˆè²»ç³»çµ±ã€‚

#### æŠ„éŒ¶è¨ˆç®—é‚è¼¯

```javascript
ç”¨é‡ = æœ¬æœŸè®€æ•¸ - ä¸ŠæœŸè®€æ•¸
é‡‘é¡ = ç”¨é‡ Ã— å–®åƒ¹
```

#### æŠ„éŒ¶è³‡æ–™æ¬„ä½

| æ¬„ä½ | èªªæ˜ | å–®ä½ |
|------|------|------|
| å®¢æˆ¶ | é—œè¯å®¢æˆ¶ | - |
| ä¸ŠæœŸè®€æ•¸ | ä¸Šæ¬¡æŠ„éŒ¶è®€æ•¸ | mÂ³ |
| æœ¬æœŸè®€æ•¸ | æœ¬æ¬¡æŠ„éŒ¶è®€æ•¸ | mÂ³ |
| æœ¬æœŸç”¨é‡ | è¨ˆç®—å¾—å‡º | mÂ³ |
| å–®åƒ¹ | æ¯ç«‹æ–¹å…¬å°ºåƒ¹æ ¼ | NT$/mÂ³ |
| é‡‘é¡ | æ‡‰æ”¶é‡‘é¡ | NT$ |
| çµ±è¨ˆæœŸé–“é–‹å§‹ | ä¸ŠæœŸæŠ„éŒ¶æ—¥æœŸ | æ—¥æœŸ |
| çµ±è¨ˆæœŸé–“çµæŸ | æœ¬æœŸæŠ„éŒ¶æ—¥æœŸ | æ—¥æœŸ |

#### æŠ„éŒ¶ç¯„ä¾‹

```
å®¢æˆ¶: é™³å…ˆç”Ÿ (ç®¡ç·šç“¦æ–¯)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¸ŠæœŸè®€æ•¸: 1,250 mÂ³           â”‚
â”‚ æœ¬æœŸè®€æ•¸: 1,358 mÂ³           â”‚
â”‚ æœ¬æœŸç”¨é‡: 108 mÂ³             â”‚
â”‚ å–®åƒ¹: NT$18/mÂ³              â”‚
â”‚ æ‡‰æ”¶é‡‘é¡: NT$1,944           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çµ±è¨ˆæœŸé–“: 2024-12-01 ~ 2025-01-25 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯é»

```
GET    /api/meter-readings/       # ç²å–æŠ„éŒ¶è¨˜éŒ„
POST   /api/meter-readings/       # å‰µå»ºæŠ„éŒ¶è¨˜éŒ„
GET    /api/meter-readings/[id]   # ç²å–å–®ä¸€è¨˜éŒ„
PUT    /api/meter-readings/[id]   # æ›´æ–°è¨˜éŒ„
DELETE /api/meter-readings/[id]   # åˆªé™¤è¨˜éŒ„
```

---

### 7ï¸âƒ£ ğŸ‘¥ å“¡å·¥ç®¡ç†

**è·¯ç”±**: `/` â†’ `staff`
**API**: `/api/staff/`

#### åŠŸèƒ½æè¿°
ç®¡ç†å“¡å·¥äººå“¡å¸³è™Ÿèˆ‡è§’è‰²æ¬Šé™ã€‚

#### è§’è‰²é¡å‹èˆ‡æ¬Šé™

| è§’è‰² | ä»£ç¢¼ | æ¬Šé™ç¯„åœ |
|------|------|----------|
| ç³»çµ±ç®¡ç†å“¡ | `admin` | å…¨éƒ¨åŠŸèƒ½ (è€é—†å¨˜) |
| ä¸€èˆ¬å“¡å·¥ | `staff` | å®¢æˆ¶ã€è¨‚å–®ã€åº«å­˜ |
| å¸æ©Ÿ | `driver` | é…é€è¨˜éŒ„ |
| æœƒè¨ˆ | `accountant` | æˆæœ¬ã€å ±è¡¨ã€æ”¯ç¥¨ |

#### å“¡å·¥è³‡æ–™æ¬„ä½

| æ¬„ä½ | èªªæ˜ | å¿…å¡« |
|------|------|------|
| ç”¨æˆ¶å | ç™»å…¥å¸³è™Ÿ (å”¯ä¸€) | âœ… |
| å¯†ç¢¼ | bcrypt åŠ å¯† | âœ… |
| å§“å | çœŸå¯¦å§“å | âœ… |
| Email | é›»å­éƒµä»¶ (å”¯ä¸€) | âœ… |
| æ‰‹æ©Ÿ | è¯çµ¡é›»è©± | - |
| è§’è‰² | admin/staff/driver/accountant | âœ… |
| éƒ¨é–€ | sales/delivery/accounting/management | - |
| å•Ÿç”¨ç‹€æ…‹ | true/false | âœ… |

#### å¯†ç¢¼å®‰å…¨

```javascript
// è¨»å†Šæ™‚åŠ å¯†
hashedPassword = await bcrypt.hash(plainPassword, 10)

// ç™»å…¥æ™‚é©—è­‰
isValid = await bcrypt.verify(plainPassword, hashedPassword)
```

#### API ç«¯é»

```
GET    /api/staff/       # ç²å–å“¡å·¥åˆ—è¡¨
POST   /api/staff/       # å‰µå»ºå“¡å·¥
GET    /api/staff/[id]   # ç²å–å“¡å·¥è©³æƒ…
PUT    /api/staff/[id]   # æ›´æ–°å“¡å·¥
DELETE /api/staff/[id]   # åˆªé™¤å“¡å·¥
```

---

### 8ï¸âƒ£ ğŸ’° æˆæœ¬åˆ†æ

**è·¯ç”±**: `/` â†’ `costs`
**API**: `/api/costs/` + `/api/cost-analysis/`

#### åŠŸèƒ½æè¿°
è¨˜éŒ„æ‰€æœ‰ç‡Ÿé‹æˆæœ¬ï¼Œåˆ†æåˆ©æ½¤ç‹€æ³ã€‚

#### æˆæœ¬é¡å‹

| é¡å‹ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `purchase` | é€²è²¨æˆæœ¬ | ç“¦æ–¯é€²è²¨ $50,000 |
| `delivery` | é…é€æˆæœ¬ | æ²¹è³‡ $500 |
| `labor` | äººå·¥æˆæœ¬ | å¸æ©Ÿè–ªè³‡ $30,000 |
| `utility` | æ°´é›»è²» | é›»è²» $3,500 |
| `rent` | ç§Ÿé‡‘ | åº—é¢ç§Ÿé‡‘ $25,000 |
| `maintenance` | ç¶­è­·è²» | è»Šè¼›ä¿é¤Š $2,000 |
| `other` | å…¶ä»– | é›œé …è²»ç”¨ |

#### æˆæœ¬è¨˜éŒ„çµæ§‹

```javascript
{
  type: "purchase",           // æˆæœ¬é¡å‹
  category: "ç“¦æ–¯é€²è²¨",        // åˆ†é¡
  amount: 50000,              // ç¸½é‡‘é¡
  date: "2025-01-25",         // ç™¼ç”Ÿæ—¥æœŸ
  description: "20kg ç“¦æ–¯ 100æ¡¶", // æè¿°
  items: [                    // æ˜ç´°
    { item: "20kg ç“¦æ–¯", quantity: 100, unitPrice: 480, subtotal: 48000 },
    { item: "é‹è²»", quantity: 1, unitPrice: 2000, subtotal: 2000 }
  ],
  recordedBy: "admin"         // è¨˜éŒ„äºº
}
```

#### åˆ©æ½¤è¨ˆç®—

```javascript
ç‡Ÿæ”¶ = æ‰€æœ‰è¨‚å–®ç¸½é¡
æˆæœ¬ = æ‰€æœ‰æˆæœ¬è¨˜éŒ„ç¸½é¡
åˆ©æ½¤ = ç‡Ÿæ”¶ - æˆæœ¬
åˆ©æ½¤ç‡ = (åˆ©æ½¤ / ç‡Ÿæ”¶) Ã— 100%
```

#### API ç«¯é»

```
GET    /api/costs/            # ç²å–æˆæœ¬è¨˜éŒ„
POST   /api/costs/            # å‰µå»ºæˆæœ¬è¨˜éŒ„
GET    /api/cost-analysis/    # ç²å–æˆæœ¬åˆ†æå ±è¡¨
```

---

### 9ï¸âƒ£ ğŸ“„ æœˆçµå ±è¡¨

**è·¯ç”±**: `/` â†’ `monthly`
**API**: `/api/monthly-statements/`

#### åŠŸèƒ½æè¿°
ç‚ºæœˆçµå®¢æˆ¶è‡ªå‹•ç”Ÿæˆæ¯æœˆå¸³å–®ã€‚

#### æœˆçµå–®çµæ§‹

```javascript
{
  customerId: "å®¢æˆ¶ID",
  month: "2025-01",              // æ ¼å¼: YYYY-MM
  periodStart: "2025-01-01",
  periodEnd: "2025-01-31",
  totalOrders: 15,               // ç•¶æœˆè¨‚å–®æ•¸
  totalAmount: 45600,            // ç¸½é‡‘é¡
  paidAmount: 20000,             // å·²ä»˜æ¬¾
  balance: 25600,                // æ¬ æ¬¾é¤˜é¡
  status: "sent"                 // draft/sent/paid/overdue
}
```

#### æœˆçµç‹€æ…‹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  draft   â”‚â”€â”€â”€â–¶â”‚   sent   â”‚â”€â”€â”€â–¶â”‚   paid   â”‚
â”‚  è‰ç¨¿    â”‚    â”‚  å·²ç™¼é€   â”‚    â”‚  å·²ä»˜æ¬¾   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ overdue  â”‚
                â”‚   é€¾æœŸ   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è‡ªå‹•è¨ˆç®—é‚è¼¯

```javascript
// 1. ç²å–è©²æœˆæ‰€æœ‰è¨‚å–®
orders = await db.gasOrder.findMany({
  where: {
    customerId,
    orderDate: { gte: periodStart, lte: periodEnd }
  }
})

// 2. è¨ˆç®—ç¸½é¡
totalAmount = sum(orders.total - orders.paidAmount)

// 3. æª¢æŸ¥å·²ä»˜æ¬¾
paidAmount = sum(orders.paidAmount)

// 4. è¨ˆç®—é¤˜é¡
balance = totalAmount - paidAmount

// 5. åˆ¤æ–·ç‹€æ…‹
if (paidAmount >= totalAmount) status = "paid"
else if (periodEnd < today) status = "overdue"
else status = "sent"
```

#### API ç«¯é»

```
GET    /api/monthly-statements/       # ç²å–æœˆçµå ±è¡¨
POST   /api/monthly-statements/       # ç”Ÿæˆæœˆçµå ±è¡¨
PATCH  /api/monthly-statements/[id]   # æ›´æ–°ç‹€æ…‹/ä»˜æ¬¾
```

---

### ğŸ”Ÿ ğŸ“ ä¾†é›»è¨˜éŒ„

**è·¯ç”±**: `/` â†’ `calls`
**API**: `/api/call-records/`

#### åŠŸèƒ½æè¿°
è¨˜éŒ„æ‰€æœ‰ä¾†é›»ï¼Œå¯é—œè¯å®¢æˆ¶èˆ‡è¨‚å–®ã€‚

#### ä¾†é›»ç‹€æ…‹

| ç‹€æ…‹ | èªªæ˜ | é¡è‰²æ¨™ç¤º |
|------|------|----------|
| `incoming` | å·²æ¥è½ | ğŸŸ¢ ç¶ è‰² |
| `outgoing` | å·²æ’¥å‡º | ğŸ”µ è—è‰² |
| `missed` | æœªæ¥ä¾†é›» | ğŸ”´ ç´…è‰² |
| `rejected` | å·²æ‹’æ¥ | âš« ç°è‰² |

#### ä¾†é›»è¨˜éŒ„æ¬„ä½

```javascript
{
  customerId: "å®¢æˆ¶ID (å¯é¸)",
  phoneNumber: "0912345678",
  callTime: "2025-01-25T14:30:00Z",
  duration: 180,              // é€šè©±æ™‚é•· (ç§’)
  status: "incoming",
  notes: "å®¢æˆ¶è©¢å• 20kg ç“¦æ–¯åƒ¹æ ¼ï¼Œä¸‹å–® 2æ¡¶"
}
```

#### èˆ‡èªéŸ³ç³»çµ±æ•´åˆ

ç•¶èªéŸ³æœå‹™ä¾†é›»æ™‚ï¼Œè‡ªå‹•è§¸ç™¼ `/api/voice/webhook/`ï¼š

```javascript
// èªéŸ³ç³»çµ±ä¾†é›» â†’ è‡ªå‹•è¨˜éŒ„
POST /api/voice/webhook/
{
  eventType: "call.incoming",
  phoneNumber: "0912345678",
  recordingUrl: "https://...",
  transcript: "æˆ‘è¦è¨‚ 20kg ç“¦æ–¯ 2æ¡¶"
}

â†’ è‡ªå‹•å‰µå»º CallRecord
â†’ AI è­˜åˆ¥æ„åœ–
â†’ å¯é¸: è‡ªå‹•å‰µå»ºè¨‚å–®
```

#### API ç«¯é»

```
GET    /api/call-records/       # ç²å–ä¾†é›»è¨˜éŒ„
POST   /api/call-records/       # æ‰‹å‹•æ–°å¢è¨˜éŒ„
GET    /api/call-records/[id]   # ç²å–å–®ä¸€è¨˜éŒ„
PUT    /api/call-records/[id]   # æ›´æ–°è¨˜éŒ„
```

---

### 1ï¸âƒ£1ï¸âƒ£ ğŸ“¢ ç‡ŸéŠ·ç®¡ç†

**è·¯ç”±**: `/` â†’ `marketing`
**API**: `/api/promotions/`

#### åŠŸèƒ½æè¿°
ç®¡ç†ä¿ƒéŠ·æ´»å‹•èˆ‡å„ªæƒ æ–¹æ¡ˆã€‚

#### ä¿ƒéŠ·é¡å‹

| é¡å‹ | ä»£ç¢¼ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| æŠ˜æ‰£æ´»å‹• | `discount` | ç™¾åˆ†æ¯”æŠ˜æ‰£ | å…¨é¤¨ 9 æŠ˜ |
| å…é‹è²» | `free_delivery` | å…é‹è²» | å…¨é¤¨å…é‹è²» |
| ç‰¹åƒ¹ | `special_price` | ç‰¹å®šåƒ¹æ ¼ | 20kg ç“¦æ–¯ $599 |
| å¥—è£å„ªæƒ  | `bundle` | è²·Xé€Y | è²·10é€1 |

#### ä¿ƒéŠ·æ´»å‹•çµæ§‹

```javascript
{
  name: "æ˜¥ç¯€å„ªæƒ æ´»å‹•",
  type: "discount",
  discountValue: 0.1,           // 10% æŠ˜æ‰£
  minAmount: 1000,              // æœ€ä½æ¶ˆè²» NT$1,000
  startDate: "2025-02-01",
  endDate: "2025-02-15",
  description: "æ˜¥æœŸé–“å…¨é¤¨9æŠ˜å„ªæƒ ",
  isActive: true
}
```

#### æ´»å‹•æ‡‰ç”¨é‚è¼¯

```javascript
// å‰µå»ºè¨‚å–®æ™‚æª¢æŸ¥ä¿ƒéŠ·
activePromotions = await db.promotion.findMany({
  where: {
    isActive: true,
    startDate: { lte: today },
    endDate: { gte: today }
  }
})

// æ‡‰ç”¨ä¿ƒéŠ·
for promotion in activePromotions:
  if (orderTotal >= promotion.minAmount):
    applyPromotion(promotion)
```

#### API ç«¯é»

```
GET    /api/promotions/       # ç²å–ä¿ƒéŠ·æ´»å‹•
POST   /api/promotions/       # å‰µå»ºä¿ƒéŠ·æ´»å‹•
PUT    /api/promotions/[id]   # æ›´æ–°æ´»å‹•
DELETE /api/promotions/[id]   # åˆªé™¤æ´»å‹•
```

---

### 1ï¸âƒ£2ï¸âƒ£ ğŸ“ˆ çµ±è¨ˆåˆ†æ

**è·¯ç”±**: `/` â†’ `reports`
**API**: å„æ¨¡çµ„å…§å»ºçµ±è¨ˆ

#### åŠŸèƒ½æè¿°
å¤šç¶­åº¦ç‡Ÿé‹æ•¸æ“šåˆ†æèˆ‡åœ–è¡¨å±•ç¤ºã€‚

#### çµ±è¨ˆæŒ‡æ¨™

```javascript
// ç‡Ÿæ”¶çµ±è¨ˆ
{
  today: 12500,           // ä»Šæ—¥ç‡Ÿæ”¶
  thisWeek: 78500,        // æœ¬é€±ç‡Ÿæ”¶
  thisMonth: 312000,      // æœ¬æœˆç‡Ÿæ”¶
  growth: +15.5           // æˆé•·ç‡ vs ä¸ŠæœŸ
}

// è¨‚å–®çµ±è¨ˆ
{
  today: 12,
  thisWeek: 67,
  thisMonth: 245,
  avgOrderValue: 1273     // å¹³å‡è¨‚å–®é‡‘é¡
}

// å®¢æˆ¶çµ±è¨ˆ
{
  total: 156,
  newThisMonth: 12,
  active: 89,             // 90å¤©å…§æœ‰è¨‚å–®
  churnRate: 3.2          // æµå¤±ç‡ %
}

// åº«å­˜çµ±è¨ˆ
{
  lowStock: 5,            // ä½æ–¼å®‰å…¨åº«å­˜
  outOfStock: 2,          // ç¼ºè²¨
  totalValue: 485000      // åº«å­˜ç¸½å€¼
}
```

#### åœ–è¡¨é¡å‹

| åœ–è¡¨ | ç”¨é€” | æ•¸æ“šä¾†æº |
|------|------|----------|
| ğŸ“Š æŠ˜ç·šåœ– | ç‡Ÿæ”¶è¶¨å‹¢ | è¨‚å–®æ—¥æœŸåˆ†çµ„ |
| ğŸ“Š æŸ±ç‹€åœ– | ç”¢å“éŠ·å”®æ’è¡Œ | è¨‚å–®æ˜ç´°çµ±è¨ˆ |
| ğŸ¥§ åœ“é¤…åœ– | å®¢æˆ¶åˆ†ä½ˆ | å®¢æˆ¶åˆ†çµ„ |
| ğŸ“Š é¢ç©åœ– | åº«å­˜è®ŠåŒ– | åº«å­˜äº¤æ˜“è¨˜éŒ„ |

#### æ™‚é–“ç¯„åœ

- è¿‘ 7 å¤©
- è¿‘ 30 å¤©
- è¿‘ 90 å¤©
- è¿‘ 1 å¹´
- è‡ªè¨‚ç¯„åœ

---

### 1ï¸âƒ£3ï¸âƒ£ ğŸ”— LINE Bot ç®¡ç†

**è·¯ç”±**: `/` â†’ `linebot`
**API**: `/api/linebot/` + `/api/line/webhook`

#### åŠŸèƒ½æè¿°
é€é LINE å¹³å°ç™¼é€é€šçŸ¥èˆ‡å®¢æˆ¶äº’å‹•ã€‚

#### LINE Bot ç¾¤çµ„é¡å‹

| ç¾¤çµ„é¡å‹ | ä»£ç¢¼ | ç”¨é€” | æˆå“¡ |
|----------|------|------|------|
| ç®¡ç†ç¾¤ | `admin` | è€é—†å¨˜èˆ‡ç®¡ç†è€… | 5äºº |
| å¸æ©Ÿç¾¤ | `driver` | é…é€å¸æ©Ÿ | 8äºº |
| æ¥­å‹™ç¾¤ | `sales` | æ¥­å‹™äººå“¡ | 6äºº |
| å®¢æœç¾¤ | `cs` | å®¢æœäººå“¡ | 4äºº |

#### ç¾¤çµ„æ¬Šé™

```javascript
{
  lineGroupId: "Cxxxx...",
  groupName: "ä¹ä¹ç“¦æ–¯-å¸æ©Ÿç¾¤",
  groupType: "driver",
  permissions: [
    "view_orders",        // æŸ¥çœ‹è¨‚å–®
    "update_delivery",    // æ›´æ–°é…é€ç‹€æ…‹
    "view_customers"      // æŸ¥çœ‹å®¢æˆ¶è³‡è¨Š
  ],
  isActive: true,
  memberCount: 8
}
```

#### è¨Šæ¯é¡å‹

```javascript
// æ–‡å­—è¨Šæ¯
{
  type: "text",
  content: "æ–°è¨‚å–®: ç‹å°æ˜ - 20kg ç“¦æ–¯ 2æ¡¶"
}

// åœ–ç‰‡è¨Šæ¯
{
  type: "image",
  content: "https://example.com/order.jpg"
}

// èªéŸ³è¨Šæ¯
{
  type: "audio",
  content: "https://example.com/voice.m4a"
}
```

#### æ„åœ–è­˜åˆ¥

```javascript
// ç”¨æˆ¶è¨Šæ¯ â†’ AI è­˜åˆ¥æ„åœ–
{
  messageType: "text",
  content: "æˆ‘è¦è¨‚ 20kg ç“¦æ–¯",
  intent: "create_order",
  response: "è«‹å‘Šè¨´æˆ‘æ‚¨çš„å§“åå’Œé…é€åœ°å€"
}
```

#### LINE Webhook æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LINE ç”¨æˆ¶   â”‚â”€â”€â”€â–¶â”‚ LINE Platformâ”‚â”€â”€â”€â–¶â”‚ /api/line/  â”‚
â”‚  ç™¼é€è¨Šæ¯    â”‚    â”‚              â”‚    â”‚  webhook    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚  AI è­˜åˆ¥    â”‚
                                      â”‚  æ„åœ–       â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â–¼              â–¼              â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ æŸ¥è©¢è¨‚å–® â”‚  â”‚ å‰µå»ºè¨‚å–® â”‚  â”‚ å®¢æˆ¶æœå‹™ â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯é»

```
POST   /api/line/webhook      # LINE Webhook æ¥æ”¶
GET    /api/linebot/groups    # ç²å–ç¾¤çµ„åˆ—è¡¨
POST   /api/linebot/send      # ç™¼é€è¨Šæ¯
GET    /api/linebot/messages  # ç²å–è¨Šæ¯è¨˜éŒ„
```

---

## ğŸ¤– AI åŠ©æ‰‹ç³»çµ± (BossJy-99åŠ©æ‰‹)

### ç³»çµ±æ¦‚è¿°

**BossJy-99åŠ©æ‰‹** æ˜¯åŸºæ–¼ GLM-4.7 çš„æ™ºèƒ½ AI åŠ©æ‰‹ï¼Œå°ˆç‚ºè€å¹´ç”¨æˆ¶è¨­è¨ˆçš„èªéŸ³äº¤äº’ç³»çµ±ã€‚

### æ ¸å¿ƒæ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BossJy-99 AI åŠ©æ‰‹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ èªéŸ³è¼¸å…¥     â”‚  â”‚  å°è©±ç•Œé¢    â”‚  â”‚ èªéŸ³è¼¸å‡º     â”‚        â”‚
â”‚  â”‚ (STT)       â”‚  â”‚ (Chat UI)   â”‚  â”‚ (TTS)       â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    GLM-4.7 AI å¼•æ“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ è‡ªç„¶èªè¨€     â”‚  â”‚ æ·±åº¦æ€è€ƒ     â”‚  â”‚ åŸ·è¡Œæ“ä½œ     â”‚        â”‚
â”‚  â”‚ ç†è§£         â”‚  â”‚ (Thinking)  â”‚  â”‚ (Actions)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æœ¬åœ° AI Agent (é›¢ç·šæ¨¡å¼)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ æŒ‡ä»¤è§£æ     â”‚  â”‚ æ¨¡å¼åŒ¹é…     â”‚  â”‚ åŸ·è¡Œå›æ‡‰     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”¯æŒçš„æ“ä½œæŒ‡ä»¤

| é¡åˆ¥ | æŒ‡ä»¤ç¯„ä¾‹ | AI åŸ·è¡Œ |
|------|----------|---------|
| **è¨‚å–®** | "è¨‚ 20kg ç“¦æ–¯ 2æ¡¶ çµ¦ç‹å°å§" | å‰µå»ºè¨‚å–® |
| **å®¢æˆ¶** | "æ–°å¢å®¢æˆ¶ ç‹å°æ˜ 0912345678" | æ–°å¢å®¢æˆ¶ |
| **åº«å­˜** | "æŸ¥ä¸€ä¸‹ 20kg ç“¦æ–¯åº«å­˜" | æŸ¥è©¢åº«å­˜ |
| **ç‡Ÿæ”¶** | "é€™é€±ç”Ÿæ„æ€éº¼æ¨£" | ç‡Ÿæ”¶åˆ†æ |
| **æˆæœ¬** | "è¨˜éŒ„æˆæœ¬ é€²è²¨ 50000å…ƒ" | è¨˜éŒ„æˆæœ¬ |
| **æ”¯ç¥¨** | "è¨˜éŒ„æ”¯ç¥¨ 10000å…ƒ ä¸­åœ‹ä¿¡è¨—" | ç™»è¨˜æ”¯ç¥¨ |
| **æŠ„éŒ¶** | "æŠ„éŒ¶ è®€æ•¸ 1234" | è¨ˆç®—ç”¨é‡ |
| **çµ±è¨ˆ** | "ä»Šæ—¥çµ±å ±" | ç”Ÿæˆå ±è¡¨ |

### èªéŸ³äº¤äº’æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ¶èªªè©± â”‚ â”€â”€â–¶ â”‚ STT è­˜åˆ¥ â”‚ â”€â”€â–¶ â”‚ AI åˆ†æ  â”‚ â”€â”€â–¶ â”‚ åŸ·è¡Œæ“ä½œ â”‚
â”‚ "æˆ‘è¦è¨‚" â”‚     â”‚ æ–‡å­—è½‰æ› â”‚     â”‚ æ„åœ–è­˜åˆ¥ â”‚     â”‚ API èª¿ç”¨ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ“ä½œå®Œæˆ â”‚ â—€â”€â”€ â”‚ TTS åˆæˆ â”‚ â—€â”€â”€ â”‚ ç”Ÿæˆå›æ‡‰ â”‚ â—€â”€â”€ â”‚ API è¿”å› â”‚
â”‚ è§¸è¦ºå›é¥‹ â”‚     â”‚ æƒ…æ„ŸèªéŸ³ â”‚     â”‚ è‡ªç„¶èªè¨€ â”‚     â”‚ çµæœæ•¸æ“š â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç’°å¢ƒè®Šæ•¸é…ç½®

```bash
# GLM API é…ç½®
GLM_API_KEYS="key1,key2,key3"  # å¤š Key è¼ªæ›¿
GLM_MODEL="glm-4.7"
GLM_THINKING_ENABLED="true"
GLM_TIMEOUT="600000"

# TTS é…ç½®
TTS_SERVICE="glm"
TTS_VOICE="zh-cn-female-standard"
TTS_SPEED="1.0"
TTS_PITCH="1.0"
```

### UI çµ„ä»¶

| çµ„ä»¶ | è·¯å¾‘ | åŠŸèƒ½ |
|------|------|------|
| AIAssistant | `/src/components/AIAssistant.tsx` | ä¸»èŠå¤©ç•Œé¢ |
| SmoothVoiceChat | `/src/components/SmoothVoiceChat.tsx` | é€£çºŒå°è©± |
| VoiceInput | `/src/components/VoiceInput.tsx` | èªéŸ³è¼¸å…¥ |

---

## ç”¨æˆ¶è§’è‰²èˆ‡æ¬Šé™

### è§’è‰²å®šç¾©

| è§’è‰² | ä»£ç¢¼ | èªªæ˜ | ä¸»è¦è·è²¬ |
|------|------|------|----------|
| ç³»çµ±ç®¡ç†å“¡ | `admin` | è€é—†å¨˜ | å…¨éƒ¨åŠŸèƒ½ |
| ä¸€èˆ¬å“¡å·¥ | `staff` | åº—å“¡ | å®¢æˆ¶ã€è¨‚å–®ã€åº«å­˜ |
| å¸æ©Ÿ | `driver` | é…é€å¸æ©Ÿ | é…é€è¨˜éŒ„ |
| æœƒè¨ˆ | `accountant` | æœƒè¨ˆäººå“¡ | æˆæœ¬ã€å ±è¡¨ |

### åŠŸèƒ½æ¬Šé™çŸ©é™£

| åŠŸèƒ½æ¨¡çµ„ | admin | staff | driver | accountant |
|----------|-------|-------|--------|-------------|
| å„€è¡¨æ¿ | âœ… | âœ… | âœ… | âœ… |
| å®¢æˆ¶ç®¡ç† | âœ… | âœ… | âŒ | âŒ |
| è¨‚å–®ç®¡ç† | âœ… | âœ… | ğŸ“– | âŒ |
| åº«å­˜ç®¡ç† | âœ… | âœ… | âŒ | âŒ |
| æ”¯ç¥¨ç®¡ç† | âœ… | âŒ | âŒ | âœ… |
| æˆæœ¬åˆ†æ | âœ… | âŒ | âŒ | âœ… |
| æœˆçµå ±è¡¨ | âœ… | âŒ | âŒ | âœ… |
| å“¡å·¥ç®¡ç† | âœ… | âŒ | âŒ | âŒ |
| çµ±è¨ˆå ±è¡¨ | âœ… | âŒ | âŒ | âœ… |
| ç³»çµ±è¨­ç½® | âœ… | âŒ | âŒ | âŒ |

**åœ–ç¤º**: âœ… å®Œå…¨æ¬Šé™ | ğŸ“– åƒ…æŸ¥çœ‹ | âŒ ç„¡æ¬Šé™

---

## æ¥­å‹™æµç¨‹

### è¨‚å–®å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. å®¢æˆ¶ä¾†é›»  â”‚    â”‚  2. è¨‚å–®ç™»éŒ„  â”‚    â”‚  3. åº«å­˜ç¢ºèª  â”‚
â”‚  æˆ– LINE è¨‚å–®â”‚    â”‚  AI/æ‰‹å‹•    â”‚    â”‚  æª¢æŸ¥åº«å­˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. å‰µå»ºè¨‚å–®  â”‚    â”‚  5. æ‰£é™¤åº«å­˜  â”‚    â”‚  6. æŒ‡æ´¾å¸æ©Ÿ  â”‚
â”‚  ç”Ÿæˆè¨‚å–®è™Ÿ  â”‚    â”‚  è¨˜éŒ„è®Šå‹•    â”‚    â”‚  æ›´æ–°ç‹€æ…‹    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. å•†å“é…é€  â”‚    â”‚  8. å®¢æˆ¶ç°½æ”¶  â”‚    â”‚  9. å®Œæˆè¨‚å–®  â”‚
â”‚  å¸æ©Ÿå‡ºè²¨    â”‚    â”‚  æ›´æ–°ç‹€æ…‹    â”‚    â”‚  ç¢ºèªæ”¶æ¬¾    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. æ”¶æ¬¾è¨˜éŒ„  â”‚    â”‚ 11. æœˆçµè™•ç†  â”‚    â”‚ 12. å ±è¡¨åˆ†æ  â”‚
â”‚ ç¾é‡‘/æ”¯ç¥¨   â”‚    â”‚ (æœˆçµå®¢æˆ¶)   â”‚    â”‚ ç‡Ÿæ”¶åˆ©æ½¤    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®¢æˆ¶æœˆçµæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æœˆçµå®¢æˆ¶å¸³å‹™è™•ç†                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ç•¶æœˆè¨‚å–®ç´¯ç©                                             â”‚
â”‚     â”œâ”€ æ¯ç­†è¨‚å–®è¨˜éŒ„åˆ°å®¢æˆ¶å¸³æˆ¶                                 â”‚
â”‚     â”œâ”€ è¨ˆç®—æœªä»˜æ¬¾é‡‘é¡                                       â”‚
â”‚     â””â”€ æ›´æ–°æ¬ æ¬¾é¤˜é¡                                         â”‚
â”‚                                                             â”‚
â”‚  2. æœˆåº•ç”Ÿæˆæœˆçµå–®                                           â”‚
â”‚     â”œâ”€ ç³»çµ±è‡ªå‹•è¨ˆç®—ç¸½é¡                                     â”‚
â”‚     â”œâ”€ ç”Ÿæˆæœˆçµå ±è¡¨                                         â”‚
â”‚     â””â”€ ç™¼é€é€šçŸ¥ (LINE/éƒµä»¶)                                 â”‚
â”‚                                                             â”‚
â”‚  3. å®¢æˆ¶ä»˜æ¬¾                                                 â”‚
â”‚     â”œâ”€ è¨˜éŒ„ä»˜æ¬¾é‡‘é¡                                         â”‚
â”‚     â”œâ”€ æ›´æ–°å·²ä»˜æ¬¾é‡‘é¡                                       â”‚
â”‚     â””â”€ è¨ˆç®—å‰©é¤˜æ¬ æ¬¾                                         â”‚
â”‚                                                             â”‚
â”‚  4. é€¾æœŸè™•ç†                                                 â”‚
â”‚     â”œâ”€ æ¨™è¨˜é€¾æœŸç‹€æ…‹                                         â”‚
â”‚     â”œâ”€ ç™¼é€å‚¬æ¬¾æé†’                                         â”‚
â”‚     â””â”€ é€šçŸ¥æ¥­å‹™äººå“¡                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åº«å­˜ç®¡ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åº«å­˜ç®¡ç†å¾ªç’°                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  é€²è²¨    â”‚â”€â”€â”€â–¶â”‚  å…¥åº«    â”‚â”€â”€â”€â–¶â”‚  å¯ç”¨    â”‚             â”‚
â”‚  â”‚ purchase â”‚    â”‚  åº«å­˜+   â”‚    â”‚  åº«å­˜    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                     â”‚                       â”‚
â”‚                                     â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  ç›¤é»    â”‚â—€â”€â”€â”€â”‚  éŠ·å”®    â”‚â—€â”€â”€â”€â”‚  å‡ºè²¨    â”‚             â”‚
â”‚  â”‚ adjust   â”‚    â”‚  åº«å­˜-   â”‚    â”‚  delivery â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚       â”‚                                             â”‚        â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                      åº«å­˜è®Šå‹•è¨˜éŒ„                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API æ¥å£æ–‡æª”

### èªè­‰ API

#### ç™»å…¥
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "Uu19700413"
}

Response 200:
{
  "success": true,
  "user": {
    "id": "cm2...",
    "name": "è€é—†å¨˜",
    "username": "admin",
    "role": "admin"
  }
}

Set-Cookie: auth_token=<jwt>; HttpOnly; Path=/; Max-Age=604800
```

#### ç²å–ç•¶å‰ç”¨æˆ¶
```http
GET /api/auth/me
Cookie: auth_token=<jwt>

Response 200:
{
  "user": {
    "id": "cm2...",
    "name": "è€é—†å¨˜",
    "username": "admin",
    "role": "admin",
    "email": "boss@jytian.it.com"
  }
}
```

#### ç™»å‡º
```http
POST /api/auth/logout

Response 200:
{
  "success": true,
  "message": "ç™»å‡ºæˆåŠŸ"
}

Set-Cookie: auth_token=; Max-Age=0
```

### å®¢æˆ¶ API

#### ç²å–å®¢æˆ¶åˆ—è¡¨
```http
GET /api/customers/?search=ç‹&group=vip

Response 200:
[
  {
    "id": "cm2...",
    "name": "ç‹å°æ˜",
    "phone": "0912345678",
    "address": "å°åŒ—å¸‚ä¿¡ç¾©å€...",
    "paymentType": "cash",
    "groupId": "cm2...",
    "group": {
      "name": "VIP å®¢æˆ¶",
      "discount": 0.05
    },
    "balance": 0,
    "_count": {
      "orders": 15
    }
  }
]
```

#### å‰µå»ºå®¢æˆ¶
```http
POST /api/customers/
Content-Type: application/json

{
  "name": "æå¤§æ˜",
  "phone": "0922333444",
  "address": "å°åŒ—å¸‚å¤§å®‰å€...",
  "paymentType": "cash",
  "groupId": "cm2..."
}

Response 201:
{
  "id": "cm2...",
  "name": "æå¤§æ˜",
  "phone": "0922333444",
  "address": "å°åŒ—å¸‚å¤§å®‰å€...",
  "paymentType": "cash",
  "groupId": "cm2...",
  "balance": 0,
  "createdAt": "2025-01-25T10:30:00Z"
}
```

### è¨‚å–® API

#### å‰µå»ºè¨‚å–® (é‡è¦)
```http
POST /api/orders/
Content-Type: application/json

{
  "customerId": "cm2...",
  "items": [
    { "productId": "cm2...", "quantity": 2 },
    { "productId": "cm2...", "quantity": 1 }
  ],
  "deliveryFee": 0,
  "note": "è«‹ä¸‹åˆé…é€"
}

Response 201:
{
  "id": "cm2...",
  "orderNo": "GAS20250125001",
  "customer": {
    "name": "ç‹å°æ˜",
    "phone": "0912345678"
  },
  "items": [
    {
      "product": { "name": "20kg ç“¦æ–¯", "price": 620 },
      "quantity": 2,
      "unitPrice": 589,  // å« 5% VIP æŠ˜æ‰£
      "subtotal": 1178
    },
    {
      "product": { "name": "16kg ç“¦æ–¯", "price": 520 },
      "quantity": 1,
      "unitPrice": 494,  // å« 5% VIP æŠ˜æ‰£
      "subtotal": 494
    }
  ],
  "status": "pending",
  "subtotal": 1140,
  "discount": 60,
  "deliveryFee": 0,
  "total": 1672,
  "paidAmount": 0,
  "createdAt": "2025-01-25T10:30:00Z"
}
```

#### æ›´æ–°è¨‚å–®ç‹€æ…‹
```http
PUT /api/orders/cm2...
Content-Type: application/json

{
  "status": "delivering",
  "driverId": "cm2..."
}

Response 200:
{
  "id": "cm2...",
  "status": "delivering",
  "driver": {
    "name": "å¸æ©Ÿè€é™³",
    "phone": "0911222333"
  }
}
```

### åº«å­˜ API

#### æ›´æ–°åº«å­˜ (é€²è²¨)
```http
POST /api/inventory/
Content-Type: application/json

{
  "productId": "cm2...",
  "type": "purchase",
  "quantity": 50,
  "reason": "ç“¦æ–¯é€²è²¨"
}

Response 200:
{
  "productId": "cm2...",
  "quantity": 95,  // åŸæœ¬ 45 + 50
  "transaction": {
    "type": "purchase",
    "quantityBefore": 45,
    "quantityAfter": 95,
    "reason": "ç“¦æ–¯é€²è²¨"
  }
}
```

#### ç²å–åº«å­˜è®Šå‹•è¨˜éŒ„
```http
GET /api/inventory/transactions/?productId=cm2...

Response 200:
[
  {
    "id": "cm2...",
    "type": "delivery",
    "quantity": -2,
    "quantityBefore": 47,
    "quantityAfter": 45,
    "reason": "è¨‚å–® GAS20250125001",
    "createdAt": "2025-01-25T10:30:00Z",
    "product": {
      "name": "20kg ç“¦æ–¯"
    }
  }
]
```

---

## æ•¸æ“šæ¨¡å‹

### å¯¦é«”é—œä¿‚åœ– (ERD)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User       â”‚     â”‚  Customer     â”‚     â”‚ CustomerGroup â”‚
â”‚  (å“¡å·¥)       â”‚     â”‚  (å®¢æˆ¶)       â”‚     â”‚  (å®¢æˆ¶åˆ†çµ„)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚     â”‚ id           â”‚     â”‚ id           â”‚
â”‚ username ğŸ”‘   â”‚     â”‚ name         â”‚     â”‚ name         â”‚
â”‚ password     â”‚     â”‚ phone ğŸ”‘     â”‚     â”‚ discount     â”‚
â”‚ role         â”‚     â”‚ address      â”‚     â”‚ creditTerm   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ groupId â—€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”‚             â”‚
       â”‚             â”‚ paymentType  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚ balance      â”‚
       â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚
       â”‚ 1                1:N
       â”‚ orders               â”‚
       â”‚                      â”‚
       â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GasOrder    â”‚     â”‚  Product      â”‚
â”‚  (è¨‚å–®)       â”‚     â”‚  (ç”¢å“)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚     â”‚ id           â”‚
â”‚ orderNo ğŸ”‘    â”‚     â”‚ name         â”‚
â”‚ customerId â—€â”€â”€â”¼â”€â”€â”€â”€â”€â”‚ categoryId   â”‚
â”‚ driverId â—€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”‚ price        â”‚
â”‚ status       â”‚     â”‚ cost         â”‚
â”‚ subtotal     â”‚     â”‚ capacity     â”‚
â”‚ discount     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ deliveryFee  â”‚             â”‚
â”‚ total        â”‚             â”‚ 1
â”‚ checkId â—€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ N
       â”‚                      â”‚
       â”‚ 1                    â–¼
       â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ N            â”‚ GasOrderItem  â”‚
       â”‚              â”‚ (è¨‚å–®æ˜ç´°)    â”‚
       â–¼              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ orderId â—€â”€â”€â”€â”€â”€â”¤
â”‚    Check      â”‚     â”‚ productId â—€â”€â”€â”€â”¤
â”‚  (æ”¯ç¥¨)       â”‚     â”‚ quantity      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚ unitPrice     â”‚
â”‚ id           â”‚     â”‚ subtotal      â”‚
â”‚ checkNo ğŸ”‘    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ bankName     â”‚
â”‚ amount       â”‚       â”‚
â”‚ status       â”‚       â”‚ 1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ N
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚   Inventory   â”‚
                 â”‚  (åº«å­˜)       â”‚
                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                 â”‚ productId ğŸ”‘   â”‚
                 â”‚ quantity      â”‚
                 â”‚ minStock      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ 1
                        â”‚ N
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚InventoryTx    â”‚
                 â”‚(åº«å­˜è®Šå‹•)     â”‚
                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                 â”‚ type          â”‚
                 â”‚ quantity      â”‚
                 â”‚ quantityBeforeâ”‚
                 â”‚ quantityAfter â”‚
                 â”‚ reason        â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å‹è©³ç´°èªªæ˜

#### User (å“¡å·¥)
```prisma
model User {
  id          String   @id @default(cuid())
  username    String   @unique
  password    String   // bcrypt hash
  email       String   @unique
  name        String?
  role        String   @default("staff")
  phone       String?
  department  String?
  isActive    Boolean  @default(true)

  orders      GasOrder[]
  deliveries  DeliveryRecord[]
  costRecords CostRecord[]
}
```

#### Customer (å®¢æˆ¶)
```prisma
model Customer {
  id              String    @id @default(cuid())
  name            String
  phone           String    @unique
  address         String
  groupId         String?
  paymentType     String    @default("cash")
  note            String?
  balance         Float     @default(0)
  creditLimit     Float     @default(0)
  lastOrderAt     DateTime?
  lastMeterReadAt DateTime?

  group           CustomerGroup?
  orders          GasOrder[]
  checks          Check[]
  meterReadings   MeterReading[]
  deliveries      DeliveryRecord[]
  calls           CallRecord[]
  monthlyStatements MonthlyStatement[]
}
```

#### Product (ç”¢å“)
```prisma
model Product {
  id              String   @id @default(cuid())
  categoryId      String
  name            String
  code            String?
  price           Float
  cost            Float
  capacity        String?
  unit            String   @default("å€‹")

  category        ProductCategory
  inventory       Inventory?
  orders          GasOrderItem[]
  inventoryTx     InventoryTransaction[]
}
```

#### GasOrder (è¨‚å–®)
```prisma
model GasOrder {
  id          String   @id @default(cuid())
  customerId  String
  orderNo     String   @unique
  orderDate   DateTime @default(now())
  deliveryDate DateTime?
  status      String   @default("pending")
  subtotal    Float
  discount    Float    @default(0)
  deliveryFee Float    @default(0)
  total       Float
  paidAmount  Float    @default(0)
  note        String?
  checkId     String?  @unique
  driverId    String?

  customer    Customer
  items       GasOrderItem[]
  check       Check?
  driver      User?
  delivery    DeliveryRecord?
}
```

---

## ç³»çµ±é…ç½®

### ç’°å¢ƒè®Šæ•¸å®Œæ•´åˆ—è¡¨

```bash
# ========================================
# æ•¸æ“šåº«é…ç½®
# ========================================
DATABASE_URL="postgresql://postgres:password@localhost:5432/gas_management"
DIRECT_URL="postgresql://postgres:password@localhost:5432/gas_management"

# ========================================
# æ‡‰ç”¨ç¨‹åºé…ç½®
# ========================================
NODE_ENV="production"
PORT=9999

# ========================================
# å®‰å…¨é…ç½®
# ========================================
JWT_SECRET="your-secret-key-change-in-production"
ALLOWED_ORIGINS="https://bossai.jytian.it.com,https://jytian.it.com"
COOKIE_DOMAIN=""
SAME_SITE="none"

# ========================================
# GLM AI åŠ©æ‰‹é…ç½®
# ========================================
GLM_API_KEYS="key1,key2,key3"
GLM_API_KEY="primary-key"
GLM_MODEL="glm-4.7"
GLM_THINKING_ENABLED="true"
GLM_TIMEOUT="600000"
GLM_ENABLE_KEY_ROTATION="true"

# ========================================
# èªéŸ³æœå‹™é…ç½®
# ========================================
VOICE_PROVIDER="eightwai"
VOICE_API_KEY=""
VOICE_AUTO_ANSWER_ENABLED="true"
VOICE_NO_ANSWER_TIMEOUT="180"

# GLM STT/TTS
STT_SERVICE="glm"
TTS_SERVICE="glm"
TTS_VOICE="zh-cn-female-standard"
TTS_SPEED="1.0"
TTS_PITCH="1.0"

# ========================================
# LINE Bot é…ç½®
# ========================================
LINE_CHANNEL_ACCESS_TOKEN="your-token"
LINE_CHANNEL_SECRET="your-secret"
LINE_USER_ID="your-user-id"
LINE_WEBHOOK_URL="https://linebot.jytian.it.com/webhook/line"

# ========================================
# æ—¥èªŒé…ç½®
# ========================================
LOG_LEVEL="info"
DATABASE_LOGGING="false"
LOG_FILE_PATH="./logs/app.log"
```

### éƒ¨ç½²é…ç½®

#### Next.js é…ç½® (next.config.ts)
```typescript
{
  output: "standalone",
  typescript: { ignoreBuildErrors: true },
  reactStrictMode: false,
  eslint: { ignoreDuringBuilds: true }
}
```

#### è³‡æ–™åº«é·ç§»
```bash
# é–‹ç™¼ç’°å¢ƒ
bun run db:push

# ç”Ÿç”¢ç’°å¢ƒ
bun run db:migrate
```

#### æ§‹å»ºèˆ‡å•Ÿå‹•
```bash
# æ§‹å»º
bun run build

# è¼¸å‡ºç›®éŒ„
.next/standalone/
â”œâ”€â”€ server.js
â”œâ”€â”€ .next/
â”‚   â”œâ”€â”€ static/
â”‚   â””â”€â”€ server/
â””â”€â”€ public/
```

---

## ğŸ“ æŠ€è¡“æ”¯æ´

### è¯çµ¡æ–¹å¼

- **é–‹ç™¼åœ˜éšŠ**: JyæŠ€è¡“åœ˜éšŠ
- **å®˜æ–¹ç¶²ç«™**: https://jytian.it.com
- **æŠ€è¡“æ–‡æª”**: CLAUDE.md

### å¸¸è¦‹å•é¡Œ

**Q: å¦‚ä½•åˆå§‹åŒ–ç³»çµ±ï¼Ÿ**
```bash
# 1. å®‰è£ä¾è³´
bun install

# 2. è¨­ç½®è³‡æ–™åº«
cp .env.example .env
# ç·¨è¼¯ .env é…ç½®

# 3. æ¨é€ Schema
bun run db:push

# 4. åˆå§‹åŒ–æ•¸æ“š
curl -X POST http://localhost:9999/api/init

# 5. å‰µå»ºç®¡ç†å“¡
curl -X POST http://localhost:9999/api/auth/init-admin
```

**Q: å¦‚ä½•é…ç½® GLM API Keyï¼Ÿ**
```bash
# æ–¹æ³• 1: ç’°å¢ƒè®Šæ•¸
GLM_API_KEY="your-key"

# æ–¹æ³• 2: LocalStorage (å‰ç«¯)
localStorage.setItem('GLM_API_KEY', 'your-key')

# æ–¹æ³• 3: å¤š Key è¼ªæ›¿
GLM_API_KEYS="key1,key2,key3"
```

**Q: å¦‚ä½•å•Ÿç”¨ LINE Botï¼Ÿ**
1. åˆ° LINE Developers Console å‰µå»º Channel
2. ç²å– Channel Access Token å’Œ Secret
3. è¨­ç½® Webhook URL
4. æ›´æ–° .env é…ç½®

---

## ğŸ“‹ ç‰ˆæœ¬æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | èªªæ˜ |
|------|------|------|
| v1.0.0 | 2025-01-25 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´åŠŸèƒ½ä¸Šç·š |

---

*æœ¬æ–‡æª”ç”± JyæŠ€è¡“åœ˜éšŠç¶­è­·ï¼Œæœ€å¾Œæ›´æ–°æ–¼ 2025-01-25*
