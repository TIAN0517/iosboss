# ä¹ä¹ç“¦æ–¯è¡Œç®¡ç†ç³»çµ± - å®Œæ•´è—åœ–

> **ç‰ˆæœ¬**: 2.0.0 Pro
> **æ›´æ–°æ—¥æœŸ**: 2025-01-25
> **æŠ€è¡“åœ˜éšŠ**: JyæŠ€è¡“åœ˜éšŠ
> **æŠ€è¡“ç¸½ç›£**: BossJy

---

## ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
2. [ç³»çµ±æ¶æ§‹è—åœ–](#ç³»çµ±æ¶æ§‹è—åœ–)
3. [æŠ€è¡“æ¶æ§‹è©³è§£](#æŠ€è¡“æ¶æ§‹è©³è§£)
4. [æ•¸æ“šæ¶æ§‹è¨­è¨ˆ](#æ•¸æ“šæ¶æ§‹è¨­è¨ˆ)
5. [æ‡‰ç”¨åŠŸèƒ½æ¨¡çµ„](#æ‡‰ç”¨åŠŸèƒ½æ¨¡çµ„)
6. [å®‰å…¨æ¶æ§‹è¨­è¨ˆ](#å®‰å…¨æ¶æ§‹è¨­è¨ˆ)
7. [éƒ¨ç½²æ¶æ§‹æ–¹æ¡ˆ](#éƒ¨ç½²æ¶æ§‹æ–¹æ¡ˆ)
8. [é–‹ç™¼è¦ç¯„æŒ‡å—](#é–‹ç™¼è¦ç¯„æŒ‡å—)

---

# å°ˆæ¡ˆæ¦‚è¿°

## æ ¸å¿ƒå®šä½

**ä¹ä¹ç“¦æ–¯è¡Œç®¡ç†ç³»çµ±** æ˜¯ä¸€æ¬¾å°ˆç‚ºå°ç£ç“¦æ–¯è¡Œæ¥­è¨­è¨ˆçš„æ™ºèƒ½ç®¡ç†å¹³å°ï¼Œé‡å°ä¸­è€å¹´ç”¨æˆ¶ï¼ˆè€é—†å¨˜ï¼‰é€²è¡Œäº†æ·±åº¦ iOS å„ªåŒ–ï¼Œæ”¯æ´ PWA éƒ¨ç½²ã€‚

## è¨­è¨ˆåŸå‰‡

| åŸå‰‡ | èªªæ˜ | å¯¦ç¾ |
|------|------|------|
| **é•·è€…å‹å–„** | å¤§å­—é«”ã€å¤§æŒ‰éˆ•ã€ç°¡åŒ–æ“ä½œ | iOS å„ªåŒ– UI çµ„ä»¶ |
| **iOS-First** | å®Œå…¨é‡å° iOS Safari å„ªåŒ– | PWA + Safe Area æ”¯æ´ |
| **ç§»å‹•å„ªå…ˆ** | éŸ¿æ‡‰å¼è¨­è¨ˆï¼Œè§¸æ§å„ªåŒ– | 52px+ è§¸æ§ç›®æ¨™ |
| **é›¶éŒ¯èª¤** | è€å¹´ç”¨æˆ¶ç„¡æ³•å¾éŒ¯èª¤æ¢å¾© | å®Œæ•´é©—è­‰ + äº‹å‹™è™•ç† |
| **AI è³¦èƒ½** | GLM-4.7 æ™ºèƒ½åŠ©æ‰‹ | BossJy-99 åŠ©æ‰‹ |
| **å“ç‰Œä¸€è‡´** | çµ±ä¸€å“ç‰Œå½¢è±¡ | BrandIcon çµ„ä»¶ |

## æŠ€è¡“æ£§ç¸½è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯å±¤ (Frontend)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Next.js 15  â”‚  React 19  â”‚  Tailwind CSS 4  â”‚  shadcn/ui   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ç‹€æ…‹ç®¡ç†èˆ‡å·¥å…·                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Zustand  â”‚  TanStack Query  â”‚  Framer Motion  â”‚  date-fns  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     æ•¸æ“šå±¤ (Data)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Prisma ORM  â”‚  PostgreSQL  â”‚  bcryptjs  â”‚  JWT             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    AI èˆ‡èªéŸ³æœå‹™                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GLM-4.7  â”‚  Web Speech API  â”‚  Socket.IO  â”‚  LINE Bot      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

# ç³»çµ±æ¶æ§‹è—åœ–

## åˆ†å±¤æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å±•ç¤ºå±¤ (Presentation)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ iOS Safari â”‚  â”‚  Chrome   â”‚  â”‚  Desktop   â”‚              â”‚
â”‚  â”‚   PWA      â”‚  â”‚   PWA     â”‚  â”‚  Browser   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ‡‰ç”¨å±¤ (Application)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              Next.js 15 + React 19                   â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚  â”‚  â”‚   Pages    â”‚  â”‚Components  â”‚  â”‚   Hooks    â”‚    â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ¥­å‹™å±¤ (Business Logic)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    API Routes                        â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚  â”‚  â”‚  Auth    â”‚ â”‚ Orders   â”‚ â”‚Inventory â”‚ â”‚  Costs  â”‚ â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•¸æ“šå±¤ (Data Layer)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                   Prisma ORM                         â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚  â”‚  â”‚ Validation â”‚  â”‚  Models    â”‚  â”‚Transactionsâ”‚    â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å­˜å„²å±¤ (Storage Layer)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              PostgreSQL Database                     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¤–éƒ¨æœå‹™å±¤ (External Services)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  GLM AI  â”‚ â”‚ LINE Bot â”‚ â”‚  Voice   â”‚ â”‚ Payment  â”‚        â”‚
â”‚  â”‚   API    â”‚ â”‚   API    â”‚ â”‚ Service  â”‚ â”‚ Gateway  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é …ç›®çµæ§‹

```
src/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx               # æ ¹å¸ƒå±€ï¼ˆå­—é«”ã€iOS metaï¼‰
â”‚   â”œâ”€â”€ page.tsx                 # ä¸»é ï¼ˆSPA å°èˆªæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ login/                   # ç™»å…¥é é¢
â”‚   â”œâ”€â”€ globals.css              # å…¨å±€æ¨£å¼ï¼ˆiOS å„ªåŒ–ï¼‰
â”‚   â””â”€â”€ api/                     # API è·¯ç”±
â”‚       â”œâ”€â”€ auth/                # èªè­‰ API
â”‚       â”œâ”€â”€ customers/           # å®¢æˆ¶ CRUD
â”‚       â”œâ”€â”€ orders/              # è¨‚å–® CRUD
â”‚       â”œâ”€â”€ inventory/           # åº«å­˜ç®¡ç†
â”‚       â”œâ”€â”€ checks/              # æ”¯ç¥¨ç®¡ç†
â”‚       â”œâ”€â”€ costs/               # æˆæœ¬è¨˜éŒ„
â”‚       â”œâ”€â”€ call-records/        # ä¾†é›»è¨˜éŒ„
â”‚       â”œâ”€â”€ monthly-statements/  # æœˆçµå ±è¡¨
â”‚       â”œâ”€â”€ meter-readings/      # æŠ„éŒ¶è¨˜éŒ„
â”‚       â”œâ”€â”€ staff/               # å“¡å·¥ç®¡ç†
â”‚       â”œâ”€â”€ promotions/          # ä¿ƒéŠ·æ´»å‹•
â”‚       â”œâ”€â”€ linebot/             # LINE Bot
â”‚       â””â”€â”€ voice/               # èªéŸ³ Webhook
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                      # shadcn/ui åŸºç¤çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ ios-button.tsx       # iOS æŒ‰éˆ•ï¼ˆè§¸è¦ºå›é¥‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ ios-input.tsx        # iOS è¼¸å…¥æ¡†ï¼ˆé˜²è‡ªå‹•ç¸®æ”¾ï¼‰
â”‚   â”‚   â”œâ”€â”€ ios-card.tsx         # iOS å¡ç‰‡ï¼ˆå¤§è§¸æ§ï¼‰
â”‚   â”‚   â”œâ”€â”€ ios-modal.tsx        # iOS æ¨¡æ…‹æ¡†
â”‚   â”‚   â”œâ”€â”€ ios-sheet.tsx        # iOS åº•éƒ¨æŠ½å±œ
â”‚   â”‚   â”œâ”€â”€ ios-tabbar.tsx       # iOS æ¨™ç±¤æ¬„
â”‚   â”‚   â”œâ”€â”€ ios-switch.tsx       # iOS åˆ‡æ›é–‹é—œ
â”‚   â”‚   â””â”€â”€ ios-alert.tsx        # iOS è­¦å‘Šå°è©±æ¡†
â”‚   â”‚
â”‚   â”œâ”€â”€ BrandIcon.tsx            # å“ç‰Œåœ–æ¨™ï¼ˆçµ±ä¸€ä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ IOSTabBar.tsx            # ç§»å‹•ç«¯åº•éƒ¨å°èˆª
â”‚   â”‚
â”‚   â”œâ”€â”€ AIAssistant.tsx          # AI åŠ©æ‰‹ç•Œé¢
â”‚   â”œâ”€â”€ SmoothVoiceChat.tsx      # é€£çºŒèªéŸ³å°è©±
â”‚   â”œâ”€â”€ VoiceInput.tsx           # èªéŸ³è¼¸å…¥
â”‚   â”œâ”€â”€ RealtimeVoiceChat.tsx    # å¯¦æ™‚èªéŸ³èŠå¤©
â”‚   â”‚
â”‚   â”œâ”€â”€ Dashboard.tsx            # å„€è¡¨æ¿
â”‚   â”œâ”€â”€ CustomerManagement.tsx   # å®¢æˆ¶ç®¡ç†
â”‚   â”œâ”€â”€ OrderManagement.tsx      # è¨‚å–®ç®¡ç†
â”‚   â”œâ”€â”€ InventoryManagement.tsx  # åº«å­˜ç®¡ç†
â”‚   â”œâ”€â”€ CheckManagement.tsx      # æ”¯ç¥¨ç®¡ç†
â”‚   â”œâ”€â”€ CostAnalysis.tsx         # æˆæœ¬åˆ†æ
â”‚   â”œâ”€â”€ MonthlyStatementPage.tsx # æœˆçµå ±è¡¨
â”‚   â”œâ”€â”€ MeterReadingManagement.tsx # æŠ„éŒ¶ç®¡ç†
â”‚   â”œâ”€â”€ StaffManagement.tsx      # å“¡å·¥ç®¡ç†
â”‚   â”œâ”€â”€ CallRecordsPage.tsx      # ä¾†é›»è¨˜éŒ„
â”‚   â”œâ”€â”€ MarketingManagement.tsx  # ç‡ŸéŠ·ç®¡ç†
â”‚   â”œâ”€â”€ ReportsAnalysis.tsx      # çµ±è¨ˆå ±è¡¨
â”‚   â””â”€â”€ LineBotManagement.tsx    # LINE Bot ç®¡ç†
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ db.ts                    # Prisma å®¢æˆ¶ç«¯å–®ä¾‹
â”‚   â”œâ”€â”€ auth.ts                  # JWT/bcrypt å·¥å…·
â”‚   â”œâ”€â”€ validation.ts            # è¼¸å…¥é©—è­‰
â”‚   â”œâ”€â”€ logger.ts                # çµæ§‹åŒ–æ—¥èªŒ
â”‚   â”œâ”€â”€ ios-utils.ts             # iOS å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ boss-jy-99-api.ts        # GLM-4.7 é›†æˆ
â”‚   â”œâ”€â”€ ai-agent-complete.ts     # æœ¬åœ° AI Agent
â”‚   â”œâ”€â”€ natural-tts.ts           # èªéŸ³åˆæˆ
â”‚   â””â”€â”€ utils.ts                 # é€šç”¨å·¥å…·
â”‚
â””â”€â”€ hooks/
    â”œâ”€â”€ use-mobile.ts            # éŸ¿æ‡‰å¼æª¢æ¸¬
    â””â”€â”€ use-toast.ts             # Toast é€šçŸ¥
```

# æŠ€è¡“æ¶æ§‹è©³è§£

## iOS å„ªåŒ–ç³»çµ±

### å­—é«”ç³»çµ±ï¼ˆå…¨éƒ¨å¤§æ–¼é»˜èªï¼‰

| é¡å | å­—é«”å¤§å° | ç”¨é€” |
|------|----------|------|
| `.text-easy-title` | 31.5px | ä¸»æ¨™é¡Œ |
| `.text-easy-heading` | 27px | å‰¯æ¨™é¡Œ |
| `.text-easy-body` | 18px | æ­£æ–‡ï¼ˆåŸºæº–ï¼‰ |
| `.text-easy-caption` | 15.75px | èªªæ˜æ–‡å­— |

### è§¸æ§ç›®æ¨™è¦æ ¼

| é¡å | é«˜åº¦ | ç”¨é€” |
|------|------|------|
| `.button-easy-touch` | 52px | æŒ‰éˆ• |
| `.input-easy-touch` | 52px | è¼¸å…¥æ¡† |
| `.list-item-easy` | 64px | åˆ—è¡¨é … |

### CSS å„ªåŒ–å¯¦ç¾

```css
/* src/app/globals.css - iOS å„ªåŒ– */

/* é˜²æ­¢è‡ªå‹•ç¸®æ”¾ */
input, textarea, select {
  font-size: 16px !important;
}

/* å®‰å…¨å€åŸŸ */
.ios-safe-area {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
}

/* è§¸æ§å„ªåŒ– */
.button-easy-touch {
  min-height: 52px;
  min-width: 52px;
}

/* é˜²æ­¢é¸å– */
.ios-no-select {
  user-select: none;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* iOS æ»¾å‹• */
.ios-scroll {
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}
```

### è§¸è¦ºå›é¥‹ç³»çµ±

```typescript
// src/lib/ios-utils.ts

export function triggerHaptic(
  type: 'light' | 'medium' | 'heavy' | 'success' | 'warning' | 'error'
) {
  if (typeof window !== 'undefined' && 'vibrate' in navigator) {
    const patterns = {
      light: [10],
      medium: [20],
      heavy: [30],
      success: [10, 50, 10],
      warning: [20, 30, 20],
      error: [30, 20, 30, 20],
    };
    navigator.vibrate(patterns[type]);
  }
}

// å®‰å…¨å€åŸŸæª¢æ¸¬
export function getSafeAreaInset() {
  if (typeof window === 'undefined') return { top: 0, bottom: 0 };
  return {
    top: parseInt(getComputedStyle(document.documentElement)
      .getPropertyValue('safe-area-inset-top')) || 0,
    bottom: parseInt(getComputedStyle(document.documentElement)
      .getPropertyValue('safe-area-inset-bottom')) || 0,
  };
}

// iOS è¨­å‚™æª¢æ¸¬
export function isIOSDevice(): boolean {
  if (typeof window === 'undefined') return false;
  return /iPad|iPhone|iPod/.test(navigator.userAgent);
}
```

## SPA å°èˆªæ¶æ§‹

```typescript
// src/app/page.tsx - ä¸»æ§åˆ¶å™¨

type Section =
  | 'dashboard' | 'customers' | 'orders' | 'inventory'
  | 'checks' | 'costs' | 'monthly' | 'meter'
  | 'staff' | 'calls' | 'marketing' | 'reports'
  | 'linebot' | 'excel-export'

function App() {
  const [activeSection, setActiveSection] = useState<Section>('dashboard')

  // å°èˆªé¸å–®
  const menuItems = [
    { id: 'dashboard', icon: Home, label: 'é¦–é ' },
    { id: 'customers', icon: Users, label: 'å®¢æˆ¶ç®¡ç†' },
    { id: 'orders', icon: ShoppingCart, label: 'è¨‚å–®ç®¡ç†' },
    { id: 'inventory', icon: Package, label: 'åº«å­˜ç®¡ç†' },
    { id: 'checks', icon: CreditCard, label: 'æ”¯ç¥¨ç®¡ç†' },
    { id: 'costs', icon: DollarSign, label: 'æˆæœ¬åˆ†æ' },
    { id: 'monthly', icon: Calendar, label: 'æœˆçµå ±è¡¨' },
    { id: 'meter', icon: Gauge, label: 'æŠ„éŒ¶ç®¡ç†' },
    { id: 'staff', icon: UserCog, label: 'å“¡å·¥ç®¡ç†' },
    { id: 'calls', icon: Phone, label: 'ä¾†é›»è¨˜éŒ„' },
    { id: 'marketing', icon: Megaphone, label: 'ç‡ŸéŠ·ç®¡ç†' },
    { id: 'reports', icon: BarChart3, label: 'çµ±è¨ˆå ±è¡¨' },
    { id: 'linebot', icon: MessageCircle, label: 'LINE Bot' },
  ]

  // è·¯ç”±æ¸²æŸ“
  const renderSection = () => {
    switch (activeSection) {
      case 'dashboard': return <Dashboard />
      case 'customers': return <CustomerManagement />
      case 'orders': return <OrderManagement />
      case 'inventory': return <InventoryManagement />
      // ... å…¶ä»–è·¯ç”±
    }
  }

  return (
    <div className="ios-safe-area">
      {/* Desktop: å´é‚Šæ¬„ */}
      {/* Mobile: IOSTabBar */}
      {renderSection()}
    </div>
  )
}
```

## AI åŠ©æ‰‹æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BossJy-99 AI åŠ©æ‰‹ç³»çµ±                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    UI å±¤                                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚AIAssistant   â”‚  â”‚SmoothVoice  â”‚  â”‚  VoiceInput  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚(èŠå¤©ç•Œé¢)    â”‚  â”‚Chat(é€£çºŒå°è©±)â”‚  â”‚  (èªéŸ³è¼¸å…¥)   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   æ§åˆ¶å±¤ (Controller)                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚  getBossJy99     â”‚      â”‚  getNaturalTTS   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  Assistant()     â”‚      â”‚  ()              â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   æ™ºèƒ½å±¤ (Intelligence)                   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚           GLM-4.7 API (ç·šä¸Š)                  â”‚        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ chatStream()    æµå¼å°è©±                   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ parseAction()   è§£ææ“ä½œæ„åœ–               â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ executeAction() åŸ·è¡Œæ¥­å‹™æ“ä½œ               â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ API Key è¼ªæ›¿    è‡ªå‹•æ•…éšœè½‰ç§»               â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                       â”‚                                    â”‚   â”‚
â”‚  â”‚                       â–¼                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚       æœ¬åœ° AI Agent (é›¢ç·š)                    â”‚        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ processInstruction()  æŒ‡ä»¤è™•ç†            â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ æ”¯æ´è¨‚å–®ã€å®¢æˆ¶ã€åº«å­˜ç­‰æ“ä½œ                 â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ æ¨¡å¼åŒ¹é… (æ­£å‰‡è¡¨é”å¼)                      â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 åŸ·è¡Œå±¤ (Execution)                       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ è¨‚å–®æ“ä½œ â”‚ â”‚ å®¢æˆ¶æ“ä½œ â”‚ â”‚ åº«å­˜æŸ¥è©¢ â”‚ â”‚ ç‡Ÿæ”¶åˆ†æ â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ æˆæœ¬è¨˜éŒ„ â”‚ â”‚ æ”¯ç¥¨ç™»è¨˜ â”‚ â”‚ æŠ„éŒ¶è¨ˆç®— â”‚ â”‚ çµ±è¨ˆå ±è¡¨ â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

# æ•¸æ“šæ¶æ§‹è¨­è¨ˆ

## æ•¸æ“šæ¨¡å‹ ERD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ ¸å¿ƒæ¥­å‹™å¯¦é«”                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚CustomerGroupâ”‚
                    â”‚(å®¢æˆ¶åˆ†çµ„)   â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚id           â”‚
                    â”‚name         â”‚
                    â”‚discount     â”‚
                    â”‚creditTerm   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ 1
                           â”‚
                           â”‚ N
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                               â”‚
           â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Customer   â”‚                â”‚    User     â”‚
    â”‚  (å®¢æˆ¶)     â”‚                â”‚  (å“¡å·¥)     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚id           â”‚                â”‚id           â”‚
    â”‚name         â”‚                â”‚username ğŸ”‘   â”‚
    â”‚phone ğŸ”‘     â”‚                â”‚password     â”‚
    â”‚address      â”‚                â”‚role         â”‚
    â”‚paymentType  â”‚                â”‚isActive     â”‚
    â”‚groupId â—€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚      â”‚       â”‚
    â”‚balance      â”‚                â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
    â”‚creditLimit  â”‚                       â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚ 1
          â”‚                               â”‚
          â”‚ N                             â”‚ N
          â”‚                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                             â”‚
    â–¼                                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GasOrder   â”‚                           â”‚  Product    â”‚
â”‚  (è¨‚å–®)     â”‚                           â”‚  (ç”¢å“)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚id           â”‚                           â”‚id           â”‚
â”‚orderNo ğŸ”‘    â”‚                           â”‚categoryId   â”‚
â”‚customerId â—€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚name         â”‚
â”‚driverId â—€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚         â”‚price        â”‚
â”‚status       â”‚         â”‚       â”‚         â”‚cost         â”‚
â”‚subtotal     â”‚         â”‚       â”‚         â”‚capacity     â”‚
â”‚discount     â”‚         â”‚       â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â”‚deliveryFee  â”‚         â”‚       â”‚                â”‚ 1
â”‚total        â”‚         â”‚       â”‚                â”‚
â”‚checkId â—€â”€â”€â”€â”€â”¼â”€â”       â”‚       â”‚                â”‚ N
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚       â”‚       â”‚                â–¼
      â”‚         â”‚ â”‚ N     â”‚ N     â”‚ N       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚         â”‚ â”‚       â”‚       â”‚         â”‚GasOrderItem â”‚
      â–¼         â–¼ â–¼       â–¼       â–¼         â”‚(è¨‚å–®æ˜ç´°)   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Check    â”‚ â”‚ Meter   â”‚ â”‚  Call   â”‚      â”‚orderId â—€â”€â”€â”€â”¼â”€â”€â”€â”
â”‚  (æ”¯ç¥¨)     â”‚ â”‚Reading  â”‚ â”‚ Record  â”‚      â”‚productId â—€â”€â”€â”¼â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚quantity     â”‚
â”‚id           â”‚ â”‚id       â”‚ â”‚id       â”‚      â”‚unitPrice    â”‚
â”‚checkNo ğŸ”‘    â”‚ â”‚customerIdâ”‚ â”‚customerIdâ”‚ â”‚subtotal     â”‚
â”‚bankName     â”‚ â”‚previous â”‚ â”‚phoneNumberâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚amount       â”‚ â”‚current  â”‚ â”‚callTime  â”‚
â”‚status       â”‚ â”‚usage    â”‚ â”‚duration  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚amount   â”‚ â”‚status   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ•¸æ“šæ¨¡å‹

### User (ç”¨æˆ¶/å“¡å·¥)
```prisma
model User {
  id             String           @id @default(cuid())
  username       String           @unique
  password       String           # bcrypt åŠ å¯†
  email          String           @unique
  name           String?
  role           String           @default("staff")  # admin/staff/driver/accountant
  phone          String?
  department     String?
  isActive       Boolean          @default(true)
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt

  // é—œè¯
  orders         GasOrder[]
  deliveries     DeliveryRecord[]
}
```

### Customer (å®¢æˆ¶)
```prisma
model Customer {
  id                String             @id @default(cuid())
  name              String
  phone             String
  address           String
  groupId           String?
  paymentType       String             @default("cash")  # cash/monthly
  balance           Float              @default(0)
  creditLimit       Float              @default(0)
  lineUserId        String?            @unique
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt

  // é—œè¯
  group             CustomerGroup?
  orders            GasOrder[]
  checks            Check[]
  deliveries        DeliveryRecord[]
  meterReadings     MeterReading[]
  monthlyStatements MonthlyStatement[]
}
```

### GasOrder (è¨‚å–®)
```prisma
model GasOrder {
  id             String          @id @default(cuid())
  customerId     String
  orderNo        String          @unique
  orderDate      DateTime        @default(now())
  deliveryDate   DateTime?
  completedAt    DateTime?
  status         String          @default("pending")  # pending/delivering/completed/cancelled
  subtotal       Float
  discount       Float           @default(0)
  deliveryFee    Float           @default(0)
  total          Float
  paidAmount     Float           @default(0)
  driverId       String?
  deliveryNumber String?         @unique  # DN202412270001
  checkId        String?         @unique
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt

  // é—œè¯
  customer       Customer        @relation(fields: [customerId], references: [id])
  driver         User?           @relation(fields: [driverId], references: [id])
  check          Check?          @relation(fields: [checkId], references: [id])
  items          GasOrderItem[]
  delivery       DeliveryRecord?
}
```

### Product (ç”¢å“)
```prisma
model Product {
  id          String                 @id @default(cuid())
  categoryId  String
  name        String
  code        String?
  price       Float
  cost        Float
  capacity    String?
  unit        String                 @default("å€‹")
  isActive    Boolean                @default(true)
  createdAt   DateTime               @default(now())
  updatedAt   DateTime               @updatedAt

  // é—œè¯
  category    ProductCategory        @relation(fields: [categoryId], references: [id])
  inventory   Inventory?
  orders      GasOrderItem[]
}
```

### Inventory (åº«å­˜)
```prisma
model Inventory {
  id        String   @id @default(cuid())
  productId String   @unique
  quantity  Int      @default(0)
  minStock  Int      @default(10)
  updatedAt DateTime @updatedAt

  // é—œè¯
  product   Product  @relation(fields: [productId], references: [id])
}
```

## æ•¸æ“šä¸€è‡´æ€§ä¿è­‰

### è¨‚å–®å‰µå»ºäº‹å‹™
```typescript
await db.$transaction(async (tx) => {
  // 1. å‰µå»ºè¨‚å–®
  const order = await tx.gasOrder.create({ ... })

  // 2. å‰µå»ºè¨‚å–®æ˜ç´°
  await tx.gasOrderItem.createMany({ ... })

  // 3. æ‰£é™¤åº«å­˜
  await tx.inventory.updateMany({ ... })

  // 4. è¨˜éŒ„åº«å­˜è®Šå‹•
  await tx.inventoryTransaction.createMany({ ... })

  // å…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å›æ»¾
})
```

# æ‡‰ç”¨åŠŸèƒ½æ¨¡çµ„

## 1ï¸âƒ£ å®¢æˆ¶ç®¡ç† (CustomerManagement)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **å®¢æˆ¶åˆ—è¡¨** | æœå°‹ã€ç¯©é¸ã€åˆ†é  |
| **æ–°å¢å®¢æˆ¶** | å»ºç«‹æ–°å®¢æˆ¶è³‡æ–™ |
| **ç·¨è¼¯å®¢æˆ¶** | ä¿®æ”¹å®¢æˆ¶è³‡è¨Š |
| **åˆªé™¤å®¢æˆ¶** | æª¢æŸ¥é—œè¯å¾Œåˆªé™¤ |
| **å®¢æˆ¶åˆ†çµ„** | ä¸€èˆ¬ã€VIPã€æ‰¹ç™¼å•†ã€æœˆçµ |
| **ä¿¡ç”¨é¡åº¦** | è¨­å®šå®¢æˆ¶ä¿¡ç”¨é¡åº¦ |

**å®¢æˆ¶é¡å‹**:
- `cash` - ç¾é‡‘å®¢æˆ¶
- `monthly` - æœˆçµå®¢æˆ¶

**API ç«¯é»**:
```
GET    /api/customers       # åˆ—è¡¨
POST   /api/customers       # å‰µå»º
GET    /api/customers/:id   # è©³æƒ…
PUT    /api/customers/:id   # æ›´æ–°
DELETE /api/customers/:id   # åˆªé™¤
```

## 2ï¸âƒ£ è¨‚å–®ç®¡ç† (OrderManagement)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **è¨‚å–®åˆ—è¡¨** | æŒ‰æ—¥æœŸã€ç‹€æ…‹ã€å®¢æˆ¶ç¯©é¸ |
| **å‰µå»ºè¨‚å–®** | é¸æ“‡å®¢æˆ¶ã€ç”¢å“ã€æ•¸é‡ |
| **æŠ˜æ‰£è¨ˆç®—** | è‡ªå‹•æ‡‰ç”¨å®¢æˆ¶åˆ†çµ„æŠ˜æ‰£ |
| **åº«å­˜æ‰£æ¸›** | å‰µå»ºæ™‚è‡ªå‹•æ‰£åº«å­˜ |
| **è¨‚å–®ç‹€æ…‹** | pending â†’ delivering â†’ completed |
| **å¸æ©ŸæŒ‡æ´¾** | æŒ‡æ´¾é…é€å¸æ©Ÿ |

**è¨‚å–®ç‹€æ…‹æµç¨‹**:
```
pending (å¾…è™•ç†)
    â†“
delivering (é…é€ä¸­)
    â†“
completed (å·²å®Œæˆ)
```

## 3ï¸âƒ£ åº«å­˜ç®¡ç† (InventoryManagement)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **åº«å­˜åˆ—è¡¨** | å³æ™‚åº«å­˜æŸ¥è©¢ |
| **é€²è²¨ç™»è¨˜** | å¢åŠ åº«å­˜ |
| **åº«å­˜èª¿æ•´** | æ‰‹å‹•èª¿æ•´ |
| **åº«å­˜è­¦ç¤º** | ä½æ–¼æœ€å°åº«å­˜æé†’ |
| **è®Šå‹•è¨˜éŒ„** | æŸ¥çœ‹æ­·å² |

**åº«å­˜è®Šå‹•é¡å‹**:
- `purchase` - é€²è²¨
- `delivery` - é…é€å‡ºè²¨
- `return` - é€€è²¨
- `adjust` - ç›¤é»èª¿æ•´
- `damaged` - å ±æ

## 4ï¸âƒ£ æ”¯ç¥¨ç®¡ç† (CheckManagement)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **æ”¯ç¥¨åˆ—è¡¨** | æ‰€æœ‰æ”¯ç¥¨è¨˜éŒ„ |
| **ç™»è¨˜æ”¯ç¥¨** | æ–°å¢æ”¶åˆ°çš„æ”¯ç¥¨ |
| **æ”¯ç¥¨ç‹€æ…‹** | pending, deposited, cleared, bounced, cancelled |
| **åˆ°æœŸæé†’** | æ”¯ç¥¨åˆ°æœŸå‰æé†’ |

## 5ï¸âƒ£ æˆæœ¬åˆ†æ (CostAnalysis)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **æˆæœ¬è¨˜éŒ„** | è¨˜éŒ„å„é …æˆæœ¬æ”¯å‡º |
| **æˆæœ¬é¡åˆ¥** | purchase, delivery, labor, utility, rent, maintenance |
| **åˆ©æ½¤åˆ†æ** | ç‡Ÿæ”¶ - æˆæœ¬ = åˆ©æ½¤ |
| **åœ–è¡¨å±•ç¤º** | Recharts å¯è¦–åŒ– |

## 6ï¸âƒ£ æœˆçµå ±è¡¨ (MonthlyStatementPage)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **æœˆçµæ¸…å–®** | æœˆçµå®¢æˆ¶æœˆä»½å¸³å–® |
| **è‡ªå‹•ç”Ÿæˆ** | è‡ªå‹•å½™æ•´è©²æœˆè¨‚å–® |
| **ç‹€æ…‹è¿½è¹¤** | draft, sent, paid, overdue |
| **é¤˜é¡è¨ˆç®—** | ç¸½é‡‘é¡ - å·²ä»˜é‡‘é¡ = æ¬ æ¬¾ |

## 7ï¸âƒ£ æŠ„éŒ¶ç®¡ç† (MeterReadingManagement)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **æŠ„éŒ¶è¨˜éŒ„** | ç®¡ç·šç“¦æ–¯ç”¨é›»æŠ„éŒ¶ |
| **ç”¨é‡è¨ˆç®—** | æœ¬æœŸè®€æ•¸ - ä¸ŠæœŸè®€æ•¸ |
| **é‡‘é¡è¨ˆç®—** | ç”¨é‡ Ã— å–®åƒ¹ |

## 8ï¸âƒ£ ç‡Ÿé‹çµ±è¨ˆ (ReportsAnalysis)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **ç‡Ÿæ”¶å ±è¡¨** | æ¯æ—¥/æ¯é€±/æ¯æœˆç‡Ÿæ”¶ |
| **éŠ·å”®æ’è¡Œ** | ç†±éŠ·ç”¢å“æ’è¡Œ |
| **å®¢æˆ¶åˆ†æ** | å®¢æˆ¶æ¶ˆè²»æ’è¡Œ |
| **è¶¨å‹¢åœ–è¡¨** | Recharts å¯è¦–åŒ– |

## 9ï¸âƒ£ LINE Bot ç®¡ç† (LineBotManagement)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **ç¾¤çµ„ç®¡ç†** | ç®¡ç†é€£å‹•çš„ LINE ç¾¤çµ„ |
| **ç¾¤çµ„é¡å‹** | admin, driver, sales, cs, general |
| **æ¬Šé™è¨­å®š** | è¨­å®šç¾¤çµ„å¯åŸ·è¡Œæ“ä½œ |
| **è¨Šæ¯è¨˜éŒ„** | æŸ¥çœ‹æ”¶ç™¼çš„ LINE è¨Šæ¯ |

## ğŸ”Ÿ AI åŠ©æ‰‹ (AIAssistant)

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **è‡ªç„¶å°è©±** | iOS Messages é¢¨æ ¼èŠå¤© |
| **ä¸²æµå›æ‡‰** | å³æ™‚é¡¯ç¤º AI å›æ‡‰ |
| **å¿«æ·æ“ä½œ** | ä¸€éµåŸ·è¡Œå¸¸è¦‹åŠŸèƒ½ |
| **èªéŸ³è¼¸å…¥** | èªéŸ³è½‰æ–‡å­—è¼¸å…¥ |
| **èªéŸ³è¼¸å‡º** | TTS èªéŸ³æ’­æ”¾ |

**æ”¯æ´çš„æ“ä½œ**:
- `create_order` - å‰µå»ºè¨‚å–®
- `create_customer` - æ–°å¢å®¢æˆ¶
- `check_inventory` - æŸ¥è©¢åº«å­˜
- `check_revenue` - æŸ¥è©¢ç‡Ÿæ”¶
- `add_cost` - è¨˜éŒ„æˆæœ¬
- `add_check` - è¨˜éŒ„æ”¯ç¥¨
- `meter_reading` - æŠ„éŒ¶è¨ˆç®—
- `call_record` - ä¾†é›»è¨˜éŒ„

# å®‰å…¨æ¶æ§‹è¨­è¨ˆ

## èªè­‰æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    POST /api/auth/login    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ Backend â”‚
â”‚ (iOS)   â”‚                            â”‚ (Next.js)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†‘                                        â”‚
     â”‚    1. é©—è­‰ username/password           â”‚
     â”‚    2. bcrypt.compare()                 â”‚
     â”‚    3. ç”Ÿæˆ JWT token                   â”‚
     â”‚                                        â”‚
     â”‚    4. è¨­ç½® HttpOnly Cookie            â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚    Set-Cookie: auth_token=<jwt>
     â”‚
     â”‚    5. ä¿å­˜åˆ° localStorage (å¿«å–)
```

## æˆæ¬Šæ¨¡å‹

```typescript
type UserRole = 'admin' | 'staff' | 'driver' | 'accountant'

const rolePermissions: Record<UserRole, string[]> = {
  admin: ['*'],              // å…¨éƒ¨æ¬Šé™
  staff: ['orders:read', 'orders:create', 'customers:read'],
  driver: ['orders:read', 'deliveries:update'],
  accountant: ['costs:read', 'costs:create', 'checks:manage']
}
```

## å®‰å…¨æªæ–½

| æªæ–½ | å¯¦ç¾æ–¹å¼ |
|------|----------|
| **å¯†ç¢¼å“ˆå¸Œ** | bcryptï¼Œ10 rounds salt |
| **JWT æœ‰æ•ˆæœŸ** | 7 å¤© (604800 ç§’) |
| **SQL æ³¨å…¥é˜²è­·** | Prisma ORM åƒæ•¸åŒ–æŸ¥è©¢ |
| **XSS é˜²è­·** | React è‡ªå‹•è½‰ç¾© + CSP |
| **CSRF é˜²è­·** | SameSite Cookie |
| **è¼¸å…¥é©—è­‰** | Zod Schema é©—è­‰ |
| **æ—¥èªŒå¯©è¨ˆ** | çµæ§‹åŒ–æ—¥èªŒç³»çµ± |

# éƒ¨ç½²æ¶æ§‹æ–¹æ¡ˆ

## Docker éƒ¨ç½²

```yaml
# docker-compose.yml

version: '3.8'

services:
  app:
    build: .
    ports:
      - "9999:9999"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/gas_management
      - JWT_SECRET=${JWT_SECRET}
      - GLM_API_KEY=${GLM_API_KEY}
    depends_on:
      - db
    restart: unless-stopped

  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=gas_management
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - app
    restart: unless-stopped

volumes:
  postgres_data:
```

## å•Ÿå‹•è…³æœ¬

```bash
# Docker éƒ¨ç½²
docker-compose up -d

# æŸ¥çœ‹æ—¥èªŒ
docker-compose logs -f

# åœæ­¢æœå‹™
docker-compose down
```

## PM2 é…ç½®

```javascript
// ecosystem.config.js
module.exports = {
  apps: [{
    name: 'gas-management',
    script: './.next/standalone/server.js',
    instances: 2,
    exec_mode: 'cluster',
    autorestart: true,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'production',
      PORT: 9999
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
  }]
}
```

# é–‹ç™¼è¦ç¯„æŒ‡å—

## å“ç‰Œä¸€è‡´æ€§

```tsx
// âœ… æ­£ç¢º - ä½¿ç”¨ BrandIcon
import { BrandIcon } from '@/components/BrandIcon'
<BrandIcon size={24} />

// âŒ éŒ¯èª¤ - ä¸è¦ä½¿ç”¨ Flame
import { Flame } from 'lucide-react'
<Flame className="h-6 w-6" />
```

## API è·¯ç”±æ¨¡æ¿

```typescript
// src/app/api/[route]/route.ts

import { NextRequest, NextResponse } from 'next/server'
import { db } from '@/lib/db'
import { logger, RequestContext, LogCategory } from '@/lib/logger'

export async function POST(request: NextRequest) {
  const logContext = new RequestContext()
  logContext.setRequestId(logger.generateRequestId())

  try {
    const body = await request.json()

    // é©—è­‰è¼¸å…¥
    // ...

    // åŸ·è¡Œäº‹å‹™
    const result = await db.$transaction(async (tx) => {
      // ...
    })

    logger.info(LogCategory.BUSINESS, 'æ“ä½œæˆåŠŸ', logContext.get())

    return NextResponse.json(result, { status: 201 })
  } catch (error) {
    logger.error(LogCategory.API, 'æ“ä½œå¤±æ•—', error, logContext.get())
    return NextResponse.json(
      { error: 'æ“ä½œå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦' },
      { status: 500 }
    )
  }
}
```

## çµ„ä»¶è¦ç¯„

```tsx
// æ‰€æœ‰çµ„ä»¶å¿…é ˆä½¿ç”¨ 'use client'
'use client'

import { triggerHaptic } from '@/lib/ios-utils'

export function MyComponent() {
  const handleClick = () => {
    triggerHaptic('light')  // è§¸è¦ºå›é¥‹
    // ...
  }

  return (
    <button
      onClick={handleClick}
      className="button-easy-touch ios-no-select"
    >
      é»æ“Šæˆ‘
    </button>
  )
}
```

## ç’°å¢ƒé…ç½®

```bash
# .env

# æ•¸æ“šåº«
DATABASE_URL="postgresql://..."

# JWT
JWT_SECRET="å¼·å¯†ç¢¼"

# GLM AI
GLM_API_KEY="...key..."

# LINE Bot
LINE_CHANNEL_ACCESS_TOKEN="..."
LINE_CHANNEL_SECRET="..."

# èªéŸ³æœå‹™
TTS_SERVICE="glm"
TTS_VOICE="zh-cn-female-standard"

# æ—¥èªŒ
LOG_LEVEL="info"
DATABASE_LOGGING="false"
```

---

*æœ¬å®Œæ•´è—åœ–ç”± JyæŠ€è¡“åœ˜éšŠç¶­è­· â€¢ æŠ€è¡“ç¸½ç›£: BossJy*

**ç‰ˆæœ¬**: 2.0.0 Pro
**æ›´æ–°æ—¥æœŸ**: 2025-01-25
