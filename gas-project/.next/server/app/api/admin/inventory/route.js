"use strict";(()=>{var t={};t.id=841,t.ids=[841],t.modules={399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9454:(t,e,r)=>{r.r(e),r.d(e,{originalPathname:()=>m,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>k});var o={};r.r(o),r.d(o,{GET:()=>c,POST:()=>u});var n=r(3277),a=r(5265),s=r(5356),i=r(7076),d=r(4118);async function u(t){try{let{productId:e,quantity:r,operation:o}=await t.json(),n=await d.db.product.findUnique({where:{id:e}});if(!n)return i.NextResponse.json({error:"Product not found"},{status:404});let a=n.stock;"add"===o?a+=r:"subtract"===o?a=Math.max(0,a-r):"set"===o&&(a=r);let s=await d.db.product.update({where:{id:e},data:{stock:a,updatedAt:new Date}});return i.NextResponse.json(s)}catch(t){return console.error("Failed to update inventory:",t),i.NextResponse.json({error:"Failed to update inventory"},{status:500})}}async function c(t){try{let{searchParams:e}=new URL(t.url),r=parseInt(e.get("lowStockThreshold")||"5"),o=await d.db.product.findMany({include:{category:!0},orderBy:{stock:"asc"}}),n={total:o.length,inStock:o.filter(t=>t.stock>0).length,outOfStock:o.filter(t=>0===t.stock).length,lowStock:o.filter(t=>t.stock>0&&t.stock<r).length,totalStock:o.reduce((t,e)=>t+e.stock,0),lowStockProducts:o.filter(t=>t.stock>0&&t.stock<r),outOfStockProducts:o.filter(t=>0===t.stock)};return i.NextResponse.json(n)}catch(t){return console.error("Failed to get inventory stats:",t),i.NextResponse.json({error:"Failed to get inventory stats"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/inventory/route",pathname:"/api/admin/inventory",filename:"route",bundlePath:"app/api/admin/inventory/route"},resolvedPagePath:"C:\\Users\\tian7\\OneDrive\\Desktop\\媽媽ios\\gas-project\\src\\app\\api\\admin\\inventory\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:k,serverHooks:h}=l,m="/api/admin/inventory/route";function v(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:k})}},4118:(t,e,r)=>{r.d(e,{db:()=>n});let o=require("@prisma/client"),n=globalThis.prisma??new o.PrismaClient({log:["query"]})}};var e=require("../../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),o=e.X(0,[942,786],()=>r(9454));module.exports=o})();