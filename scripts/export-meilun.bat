@echo off
chcp 65001 >nul
echo ============================================
echo 從 SQL Server 匯出美崙站客戶數據
echo ============================================
echo.

REM 生成 INSERT 語句
echo 生成 INSERT 語句...
"C:\Program Files\Microsoft SQL Server\160\Tools\Binn\sqlcmd" -S BOSSJY\BOSSJY -E -d cpf47_meilun -h -1 -W -Q "SELECT 'INSERT INTO customers_meilun VALUES (''' + CustID + ''',''' + REPLACE(ISNULL(CustCorpID,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAreaID,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustName,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustShortName,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel1,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel1a,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel1b,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel2,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel2a,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel2b,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel3,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel3a,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel3b,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel4,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel4a,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel4b,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustMobilePhone,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustUnifyID,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddrZip,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustSalesID,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddr,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddrCity,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddrArea,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddrRoad,''), '''', '''''') + ''',' + CAST(ISNULL(CustAddrLane1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrLane2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrAlley1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrAlley2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrNo1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrNo2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrFloor1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustAddrFloor2,0) AS VARCHAR) + ',''' + REPLACE(ISNULL(CustAddrMemo,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddrSort,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustAddrCode,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustMemo,''), '''', '''''') + ''',NULL,' + CAST(ISNULL(CustGPSX,0) AS VARCHAR) + ',' + CAST(ISNULL(CustGPSY,0) AS VARCHAR) + ',' + CAST(ISNULL(CustTankDifference1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustTankDifference2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustTankDifference3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustTankDifference4,0) AS VARCHAR) + ',' + CAST(ISNULL(CustTankDifference5,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterDifference,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterCoefficient1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterCoefficient2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterCoefficient3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterPressure1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterPressure2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterPressure3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterCurrent1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterCurrent2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustMeterCurrent3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceCollect,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceCount1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceCount2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceCount3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceCount4,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceCount5,0) AS VARCHAR) + ',''' + REPLACE(ISNULL(CustInvoiceType,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustInvoiceTital,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustType,''), '''', '''''') + ''',' + CAST(ISNULL(CustUnbalanceFull1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceFull2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceFull3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceFull4,0) AS VARCHAR) + ',' + CAST(ISNULL(CustUnbalanceFull5,0) AS VARCHAR) + ',' + CAST(ISNULL(CustFloorExtra1,0) AS VARCHAR) + ',' + CAST(ISNULL(CustFloorExtra2,0) AS VARCHAR) + ',' + CAST(ISNULL(CustFloorExtra3,0) AS VARCHAR) + ',' + CAST(ISNULL(CustFloorExtra4,0) AS VARCHAR) + ',' + CAST(ISNULL(CustFloorExtra5,0) AS VARCHAR) + ',NULL,0,NULL,NULL,''' + REPLACE(ISNULL(CustTel5,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel5a,''), '''', '''''') + ''',''' + REPLACE(ISNULL(CustTel5b,''), '''', '''''') + ''',1);' FROM Cust" > "backups\migration\customers_meilun_inserts.sql"

echo 完成！
echo 輸出檔案: backups\migration\customers_meilun_inserts.sql

echo.
pause
