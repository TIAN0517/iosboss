# 台灣瓦斯行管理系統

一個專為台灣瓦斯行設計的專業管理系統，提供完整的客戶管理、訂單處理、庫存追蹤、成本計算和支票管理功能。

## 功能特色

### 📊 儀表板
- 實時營運數據概覽
- 今日訂單、待配送、庫存狀態
- 快速操作入口

### 👥 客戶管理
- 客戶資料管理（姓名、電話、地址）
- 客戶訂單歷史查詢
- 客戶欠款追蹤
- 搜尋和篩選功能

### 🛒 訂單管理
- 瓦斯訂單創建和管理
- 自動計算訂單金額
- 客戶分組折扣自動計算
- 配送費自動計算（滿 $2000 免運費）
- 訂單狀態追蹤（待處理、配送中、已完成）
- 自動扣除庫存

### 📦 庫存管理
- 瓦斯桶庫存追蹤
- 進貨和出庫記錄
- 庫存變動歷史
- 庫存預警

### 💰 支票管理
- 客戶支票登記
- 到期日追蹤
- 支票狀態管理（待兌現、已入帳、已清算、跳票）
- 支票關聯訂單

### 💵 成本管理
- 進貨成本記錄
- 配送成本追蹤
- 人力成本管理
- 其他營運費用記錄

### 📢 營銷活動
- 促銷活動管理
- 優惠券創建
- 客戶分組（一般客戶、VIP、批發商）
- 自動折扣計算

### 📈 報表分析
- 營業額統計
- 利潤分析
- 成本報表
- 客戶購買記錄

## 使用流程

### 1. 初始化系統
首次使用時，請在儀表板點擊「初始化系統」按鈕，系統會自動創建：
- 默認瓦斯產品（20kg 標準/高級、50kg 商用）
- 客戶分組（一般、VIP、批發商）

### 2. 新增產品
在系統初始化後，您可以：
- 編輯現有產品價格
- 新增其他規格的瓦斯產品
- 設定產品成本價

### 3. 新增客戶
- 在客戶管理中點擊「新增客戶」
- 填寫客戶姓名、電話、配送地址
- 可選擇客戶分組（自動享有對應折扣）
- 可添加備註

### 4. 管理庫存
- 記錄進貨數量
- 系統會自動更新庫存
- 訂單創建時自動扣除庫存
- 查看庫存變動歷史

### 5. 創建訂單
- 選擇客戶
- 添加瓦斯產品和數量
- 系統自動計算：
  - 小計（產品價格 × 數量）
  - 客戶折扣（根據客戶分組）
  - 配送費（滿 $2000 免費）
  - 總金額
- 設定配送日期
- 提交訂單（自動扣除庫存）

### 6. 追蹤配送
- 查看待處理訂單
- 更新訂單狀態為「配送中」
- 配送完成後更新為「已完成」

### 7. 記錄支票
- 在支票管理中新增支票
- 填寫支票號碼、銀行、金額、到期日
- 關聯對應客戶或訂單
- 追蹤支票狀態

### 8. 記錄成本
- 進貨成本
- 配送費用
- 人力成本
- 其他營運費用

## 價格計算邏輯

### 基本計算公式
```
小計 = Σ(產品價格 × 數量)
折扣 = 小計 × 客戶分組折扣率
配送費 = 小計 < 2000 ? 50 : 0
總額 = 小計 - 折扣 + 配送費
```

### 默認產品價格
- 20kg 標準瓦斯桶：NT$390
- 20kg 高級瓦斯桶：NT$450
- 50kg 商用瓦斯桶：NT$850

### 客戶分組折扣
- 一般客戶：無折扣
- VIP 客戶：5% 折扣
- 批發商：10% 折扣

## 技術架構

- **框架**：Next.js 15 (App Router)
- **語言**：TypeScript 5
- **樣式**：Tailwind CSS 4 + shadcn/ui
- **數據庫**：Prisma ORM + SQLite
- **狀態管理**：React Hooks

## 響應式設計

系統完全響應式，支持：
- 桌面瀏覽器
- 平板電腦
- 手機瀏覽器（iOS Safari、Chrome）

在 iOS 設備上，您可以直接通過 Safari 瀏覽器訪問並使用所有功能，就像原生 App 一樣流暢。

## 數據模型

系統包含以下主要數據表：
- **Customer**（客戶）
- **Product**（產品）
- **Inventory**（庫存）
- **GasOrder**（訂單）
- **GasOrderItem**（訂單明細）
- **Check**（支票）
- **CostRecord**（成本記錄）
- **Promotion**（促銷活動）
- **CustomerGroup**（客戶分組）

## API 端點

### 客戶管理
- `GET /api/customers` - 獲取客戶列表
- `POST /api/customers` - 新增客戶
- `GET /api/customers/[id]` - 獲取單一客戶
- `PUT /api/customers/[id]` - 更新客戶
- `DELETE /api/customers/[id]` - 刪除客戶

### 訂單管理
- `GET /api/orders` - 獲取訂單列表
- `POST /api/orders` - 新增訂單
- `GET /api/orders/[id]` - 獲取單一訂單
- `PUT /api/orders/[id]` - 更新訂單狀態
- `DELETE /api/orders/[id]` - 刪除訂單

### 產品管理
- `GET /api/products` - 獲取產品列表
- `POST /api/products` - 新增產品

### 庫存管理
- `GET /api/inventory` - 獲取庫存
- `POST /api/inventory` - 更新庫存
- `GET /api/inventory/transactions` - 獲取庫存變動記錄

### 支票管理
- `GET /api/checks` - 獲取支票列表
- `POST /api/checks` - 新增支票
- `PUT /api/checks/[id]` - 更新支票狀態
- `DELETE /api/checks/[id]` - 刪除支票

### 成本管理
- `GET /api/costs` - 獲取成本記錄
- `POST /api/costs` - 新增成本記錄

### 客戶分組
- `GET /api/customer-groups` - 獲取客戶分組
- `POST /api/customer-groups` - 新增客戶分組

### 促銷活動
- `GET /api/promotions` - 獲取促銷活動
- `POST /api/promotions` - 新增促銷活動

### 系統初始化
- `GET /api/init` - 檢查初始化狀態
- `POST /api/init` - 初始化系統

## 注意事項

1. **數據備份**：定期備份 SQLite 數據庫文件
2. **庫存管理**：創建訂單前請確保庫存充足
3. **支票追蹤**：及時更新支票狀態以追蹤收入
4. **成本記錄**：定期記錄營運成本以便分析利潤

## 未來功能規劃

- [ ] 發票管理（台灣電子發票）
- [ ] 財務報表和圖表
- [ ] 短信/Line 通知
- [ ] 配送路線規劃
- [ ] 客戶積點系統
- [ ] 手機 App (PWA)

## 版本

當前版本：v1.0.0

---

© 2025 台灣瓦斯行管理系統 - 專業瓦斯配送與成本管理解決方案
